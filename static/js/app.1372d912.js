(function(t){function e(e){for(var n,c,a=e[0],o=e[1],l=e[2],d=0,_=[];d<a.length;d++)c=a[d],Object.prototype.hasOwnProperty.call(i,c)&&i[c]&&_.push(i[c][0]),i[c]=0;for(n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n]);h&&h(e);while(_.length)_.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],n=!0,a=1;a<r.length;a++){var o=r[a];0!==i[o]&&(n=!1)}n&&(s.splice(e--,1),t=c(c.s=r[0]))}return t}var n={},i={app:0},s=[];function c(e){if(n[e])return n[e].exports;var r=n[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,c),r.l=!0,r.exports}c.m=t,c.c=n,c.d=function(t,e,r){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(c.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)c.d(r,n,function(e){return t[e]}.bind(null,n));return r},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],o=a.push.bind(a);a.push=e,a=a.slice();for(var l=0;l<a.length;l++)e(a[l]);var h=o;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},1:function(t,e){},2:function(t,e){},2835:function(t,e,r){"use strict";r("ad83")},"2aab":function(t,e,r){},3:function(t,e){},"306f":function(t,e,r){"use strict";r("ac5a")},3337:function(t,e,r){},3653:function(t,e,r){},3811:function(t,e,r){},4:function(t,e){},"42c7":function(t,e,r){"use strict";r("2aab")},5:function(t,e){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("7a23"),i=(r("b64b"),r("fb6a"),r("b0c0"),{class:"navbar navbar-expand-sm bg-light navbar-hover"}),s={class:"collapse navbar-collapse"},c={class:"navbar-nav mr-auto"},a={class:"nav-item dropdown"},o=Object(n["g"])("button",{class:"dropdown-toggle btn",id:"browse_samples","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}," Browse Samples ",-1),l={class:"dropdown-menu"},h={class:"dropdown-item dropdown-toggle"},d={class:"dropdown-menu"},_={key:0},u={class:"navbar-nav"},p={class:"nav-item"},f={class:"btn",disabled:""},g=Object(n["g"])("br",null,null,-1),m=Object(n["g"])("li",{class:"nav-item"},[Object(n["g"])("a",{tabindex:"0",class:"btn",role:"button","data-toggle":"popover","data-trigger":"focus",title:"Help",rel:"popover","data-content":"\n        Playback: <br> \n        <ul>\n          <li>e: reset player</li>\n          <li>r: replay</li>\n          <li>t: test</li>\n          <li>a: a to test</li>\n          <li>s: show answer</li>\n          <li>n: new sample</li>\n        </ul>\n        Input-Fixed: <br> \n        <ul>\n          <li>Mouse</li>\n          <ul>\n            <li>left click: select a major triad</li>\n            <li>right click: select a minor triad</li>\n            <li>middle click or (shift + left click): select a dominant 7th chord</li>\n            <li>alt + left/right click: select a major/minor 7th chord</li>\n          </ul>\n          <li>Keyboard</li>\n          <ul>\n            <li>'1'-'=': select root</li>\n            <li>shift + root: major triad</li>\n            <li>ctrl + root: minor triad</li>\n            <li>alt + root: moninant 7th chord</li>\n            <li>alt+ shift/ctrl + root: major/minor 7th chord</li>\n          </ul>\n        </ul>\n        Input-Movable: <br> \n        <ul>\n          <li>Mouse</li>\n          <ul>\n            <li>left click: select a triad corresponding the the scale degree</li>\n            <li>shift + left click: select a major triad</li>\n            <li>ctrl + left click: select a minor triad</li>\n            <li>alt + left click: select a dominant seventh chord</li>\n            <li>alt + shift/ctrl + left click: select a major/minor seventh chord</li>\n          </ul>\n          <li>Keyboard</li>\n          <ul>\n            <li>1-7: select a triad corresponding the the scale degree</li>\n            <li>shift + 1-7: select a major triad</li>\n            <li>ctrl + 1-7: select a minor triad</li>\n            <li>alt + 1-7: select a dominant seventh chord</li>\n            <li>alt + shift/ctrl + 1-7: select a major/minor seventh chord</li>\n          </ul>\n        </ul>\n        ","data-html":"true"}," Help "),Object(n["g"])("br")],-1),v={class:"container-fluid pt-3 pb-5",id:"main_app"},b={id:"time_steps",class:"table table-fixed prog_table"},y={class:"thead-light"},O=Object(n["g"])("th",{class:"prog_head table_cell"},null,-1),j=Object(n["g"])("th",{class:"time_cell"},null,-1),x=Object(n["g"])("th",{class:"time_cell"},null,-1),k={class:"up"},w=Object(n["g"])("svg",{class:"original_svg svg right",height:"0px"},null,-1),T={class:"up"},M={id:"original_prog",class:"table table-fixed table-striped prog_table"},q=Object(n["g"])("th",null,null,-1),D=Object(n["g"])("th",null,null,-1),I={id:"altered_time_steps",class:"table table-fixed prog_table"},S={class:"thead-light"},E=Object(n["g"])("canvas",{id:"altered_canvas",class:"right"},null,-1),P=Object(n["g"])("svg",{class:"swapped_svg svg right",id:"swapped_svg",height:"0px"},null,-1),A={class:"up"},C={id:"saved_prog",class:"table table-fixed table-striped prog_table"},B={key:0},L={class:"row"},$={class:"col-4"},U=Object(n["g"])("br",null,null,-1),R=Object(n["f"])(" Bpm: "),F={id:"bpm_text"},z={class:"slider_container"},K=Object(n["f"])(" Next bpm: "),N={id:"bpm_text"},H={class:"slider_container"},X=Object(n["f"])(" Velocity: "),V={id:"bpm_text"},Y={class:"slider_container"},W=Object(n["f"])(" Expressive dynamics: "),J={class:"slider_container"},G=Object(n["f"])(" Expressive timing: "),Z={class:"slider_container"},Q={class:"input-group-prepend"},tt={class:"input-group-text",style:{width:"160px"}},et=Object(n["f"])(),rt=Object(n["g"])("span",null,"   Root overlay",-1),nt={class:"input-group-prepend"},it={class:"input-group-text",style:{width:"160px"}},st=Object(n["f"])(),ct=Object(n["g"])("span",null,"   Chord overlay",-1),at=Object(n["g"])("br",null,null,-1),ot=Object(n["g"])("br",null,null,-1),lt=Object(n["g"])("br",null,null,-1),ht=Object(n["g"])("br",null,null,-1),dt=Object(n["g"])("br",null,null,-1),_t={key:0,class:"test_correct no_click"},ut={key:0},pt={key:1,class:"no_click"},ft={key:0},gt=Object(n["g"])("br",null,null,-1),mt={class:"dropdown"},vt={class:"btn btn-light dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},bt={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},yt=Object(n["g"])("br",null,null,-1),Ot={key:0},jt=Object(n["g"])("br",null,null,-1),xt={key:1},kt={key:2},wt={key:0},Tt={key:1},Mt={class:"col-6"},qt={class:"btn-group"},Dt={class:"btn btn-light dropdown-toggle",type:"button","data-toggle":"dropdown"},It=Object(n["g"])("span",{class:"caret"},null,-1),St={class:"dropdown-menu"},Et={key:0,class:"dropdown"},Pt={class:"btn btn-light dropdown-toggle",type:"button","data-toggle":"dropdown"},At=Object(n["g"])("span",{class:"caret"},null,-1),Ct={class:"dropdown-menu"},Bt={class:"btn-group"},Lt={class:"btn btn-light dropdown-toggle",type:"button","data-toggle":"dropdown"},$t=Object(n["g"])("span",{class:"caret"},null,-1),Ut={class:"dropdown-menu"},Rt={key:0},Ft={class:"col-1"},zt=Object(n["g"])("p",null,"Next phrase:",-1),Kt=Object(n["g"])("svg",{id:"original_barline",class:"barline_svg"},null,-1),Nt=Object(n["g"])("br",null,null,-1),Ht=Object(n["g"])("svg",{id:"altered_barline",class:"barline_svg"},null,-1),Xt={id:"melacc_toggle"},Vt={class:"input-group-prepend"},Yt={class:"input-group-text",style:{width:"160px"}},Wt=Object(n["f"])(),Jt=Object(n["g"])("span",null,"   Melody",-1),Gt={class:"input-group-prepend"},Zt={class:"input-group-text",style:{width:"160px"}},Qt=Object(n["f"])(),te=Object(n["g"])("span",null,"   Accompaniment",-1);function ee(t,e,r,ee,re,ne){var ie=this,se=Object(n["l"])("midi-visualizer"),ce=Object(n["l"])("InterfaceFixed"),ae=Object(n["l"])("InterfaceMovable"),oe=Object(n["l"])("InterfaceMovableWheel"),le=Object(n["l"])("InterfaceMovableWheelFixed"),he=Object(n["l"])("PhraseFilter"),de=Object(n["l"])("PhraseFilterWheel"),_e=Object(n["l"])("PhraseSelectDemo"),ue=Object(n["l"])("PhraseSelect"),pe=Object(n["l"])("midi-player");return Object(n["h"])(),Object(n["c"])("div",null,[Object(n["g"])("nav",i,[Object(n["g"])("div",s,[Object(n["g"])("ul",c,[Object(n["g"])("li",a,[o,Object(n["g"])("ul",l,[Object(n["g"])("li",{id:"resample",onClick:e[1]||(e[1]=function(){return ne.get_data&&ne.get_data.apply(ne,arguments)})},"Random Phrase"),(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(Object.keys(this.songData),(function(t){return Object(n["h"])(),Object(n["c"])("li",{key:t},[Object(n["g"])("a",h,"Song "+Object(n["m"])(t)+" "+Object(n["m"])(ie.songData[t]["key"]),1),Object(n["g"])("ul",d,[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(Object.keys(ie.songData[t]),(function(r){return Object(n["h"])(),Object(n["c"])("div",{key:r},["key"!=r?(Object(n["h"])(),Object(n["c"])("div",_,[Object(n["g"])("li",{onClick:e[2]||(e[2]=function(){return ne.get_data&&ne.get_data.apply(ne,arguments)})},[Object(n["g"])("a",{class:"dropdown-item phraseSelect","data-song":t,"data-segment":r}," Segment "+Object(n["m"])(r)+" "+Object(n["m"])(ie.songData[t][r]),9,["data-song","data-segment"])])])):Object(n["d"])("",!0)])})),128))])])})),128))])])]),Object(n["g"])("ul",u,[Object(n["g"])("li",p,[Object(n["g"])("button",f,"Phrase ID: "+Object(n["m"])(this.songID.slice(0,3))+": "+Object(n["m"])(this.songname)+" "+Object(n["m"])(this.songID.slice(4))+" | "+Object(n["m"])(this.songkey),1),g]),m])])]),Object(n["g"])("div",v,[Object(n["g"])("table",b,[Object(n["g"])("thead",y,[Object(n["g"])("tr",null,[O,Object(n["g"])("div",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("th",{class:"time_cell",key:t,id:"time"+(t-1)},Object(n["m"])((t+3-(t-1)%4)/4+"."+((t-1)%4+1)),9,["id"])})),64)),j,x])])])]),Object(n["g"])(se,{type:"piano-roll",class:"right",id:"original_vis",noteSequence:this.original_noteseq,config:this.cfg},null,8,["noteSequence","config"]),Object(n["g"])("div",k,[Object(n["g"])(se,{type:"piano-roll",class:"right",id:"original_vis_overlay",noteSequence:this.original_noteseq_overlay,config:this.cfg_mel},null,8,["noteSequence","config"]),w,Object(n["g"])("div",T,[Object(n["g"])("table",M,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",{id:"play_prog_original",class:"prog_head",onClick:e[3]||(e[3]=function(){return ne.play_prog_original&&ne.play_prog_original.apply(ne,arguments)})},"Original"),Object(n["g"])("div",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(e){return Object(n["g"])("td",{key:e,id:"original_prog"+(e-1),class:"table_cell",style:{"font-weight":"normal"},onClick:function(t){return ne.play_chord("original",e-1)}},Object(n["m"])(t.original_chd_str[e-1]),9,["id","onClick"])})),64)),q,D])])])]),Object(n["g"])("table",I,[Object(n["g"])("thead",S,[Object(n["g"])("tr",null,[Object(n["g"])("div",null,[Object(n["g"])("th",{class:"prog_head table_cell",onClick:e[4]||(e[4]=function(){return ne.replay_all&&ne.replay_all.apply(ne,arguments)})}),(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("th",{class:"time_cell",key:t,id:"time_altered"+(t-1),onClick:function(e){return ne.replay_bar(t-1)}},Object(n["m"])((t+3-(t-1)%4)/4+"."+((t-1)%4+1)),9,["id","onClick"])})),64)),Object(n["g"])("th",{class:"time_cell",onClick:e[5]||(e[5]=function(){return ne.replay_all&&ne.replay_all.apply(ne,arguments)})},"Replay"),Object(n["g"])("th",{class:"time_cell",onClick:e[6]||(e[6]=function(){return ne.replay_all&&ne.replay_all.apply(ne,arguments)})})])])])]),E,P,Object(n["g"])("div",A,[Object(n["g"])("table",C,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[Object(n["g"])("div",null,[Object(n["g"])("th",{id:"play_prog_original",class:"prog_head",onClick:e[7]||(e[7]=function(){return ne.play_prog_altered&&ne.play_prog_altered.apply(ne,arguments)})},"Altered"),(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(e){return Object(n["g"])("td",{key:e,id:"altered"+(e-1),class:"table_cell",style:{"font-weight":"normal"},onClick:function(t){return ne.play_chord("altered",e-1)}},[t.hide_vis_input?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("span",B,Object(n["m"])(t.altered_chd_str[e-1]),1))],8,["id","onClick"])})),64)),Object(n["g"])("th",null,[this.playing?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("span",{key:0,class:"table_tail",onClick:e[8]||(e[8]=function(){return ne.test_add&&ne.test_add.apply(ne,arguments)})},"Add to test"))])])])])]),Object(n["g"])("div",L,[Object(n["g"])("div",$,[Object(n["g"])("button",{id:"altered_reset",class:"btn btn-light",onClick:e[9]||(e[9]=function(){return ne.player_reset&&ne.player_reset.apply(ne,arguments)})},"Reset"),U,R,Object(n["g"])("span",F,Object(n["m"])(this.bpm),1),Object(n["g"])("div",z,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range slider",min:"30",max:"200","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.bpm=e}),onPointerout:e[11]||(e[11]=function(){return ne.follow_tempo&&ne.follow_tempo.apply(ne,arguments)})},null,544),[[n["n"],t.bpm]])]),K,Object(n["g"])("span",N,Object(n["m"])(this.next_bpm),1),Object(n["g"])("div",H,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range slider",min:"30",max:"200","onUpdate:modelValue":e[12]||(e[12]=function(e){return t.next_bpm=e})},null,512),[[n["n"],t.next_bpm]])]),X,Object(n["g"])("span",V,Object(n["m"])(this.velocity_scale)+"%",1),Object(n["g"])("div",Y,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range slider",id:"vel_slider",min:"5",max:"100","onUpdate:modelValue":e[13]||(e[13]=function(e){return t.velocity_scale=e})},null,512),[[n["n"],t.velocity_scale]])]),W,Object(n["g"])("span",null,[Object(n["f"])(Object(n["m"])(this.expressiveness_vel)+"% ",1),Object(n["g"])("div",J,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range slider",min:"0",max:"300","onUpdate:modelValue":e[14]||(e[14]=function(e){return t.expressiveness_vel=e})},null,512),[[n["n"],t.expressiveness_vel]])])]),G,Object(n["g"])("span",null,[Object(n["f"])(Object(n["m"])(this.expressiveness_tempo)+"% ",1),Object(n["g"])("div",Z,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range slider",min:"0",max:"300","onUpdate:modelValue":e[15]||(e[15]=function(e){return t.expressiveness_tempo=e})},null,512),[[n["n"],t.expressiveness_tempo]])])]),Object(n["g"])("div",Q,[Object(n["g"])("div",tt,[Object(n["g"])("input",{type:"checkbox",id:"root_overlay",checked:t.root_overlay,onClick:e[16]||(e[16]=function(t){return ie.root_on_click()})},null,8,["checked"]),et,rt])]),Object(n["g"])("div",nt,[Object(n["g"])("div",it,[Object(n["g"])("input",{type:"checkbox",id:"chord_overlay",checked:t.chord_overlay,onClick:e[17]||(e[17]=function(t){return ie.chord_on_click()})},null,8,["checked"]),st,ct])]),at,Object(n["g"])("div",null,[Object(n["g"])("button",{class:"btn btn-light",onClick:e[18]||(e[18]=function(){return ne.test_clear&&ne.test_clear.apply(ne,arguments)}),disabled:this.test_chd_strs.length<1||t.playing},"Clear Test",8,["disabled"]),ot,lt,Object(n["g"])("button",{class:"btn btn-light",onClick:e[19]||(e[19]=function(){return ne.test_apply&&ne.test_apply.apply(ne,arguments)}),disabled:this.test_chd_strs.length<1||t.playing},"Test",8,["disabled"]),ht,Object(n["g"])("button",{class:"btn btn-light",onClick:e[20]||(e[20]=function(){return ne.test_show_answer&&ne.test_show_answer.apply(ne,arguments)}),disabled:!t.hide_vis_input||t.playing},"Show answer",8,["disabled"]),dt]),(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(this.test_chd_strs.length,(function(e){return Object(n["h"])(),Object(n["c"])("div",{key:e},[e!=ie.test_idx+1||t.hide_vis_input?(Object(n["h"])(),Object(n["c"])("div",pt,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(4,(function(t){return Object(n["g"])("span",{key:t},[Object(n["f"])(Object(n["m"])(ie.test_chd_strs[e-1][4*(t-1)])+" ",1),t<4?(Object(n["h"])(),Object(n["c"])("span",ft,"  - ")):Object(n["d"])("",!0)])})),64))])):(Object(n["h"])(),Object(n["c"])("div",_t,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(4,(function(t){return Object(n["g"])("span",{key:t},[Object(n["f"])(Object(n["m"])(ie.test_chd_strs[e-1][4*(t-1)])+" ",1),t<4?(Object(n["h"])(),Object(n["c"])("span",ut,"  - ")):Object(n["d"])("",!0)])})),64))]))])})),128)),gt,Object(n["g"])("button",{class:"btn btn-light",onClick:e[21]||(e[21]=function(){return ne.connect_midi&&ne.connect_midi.apply(ne,arguments)})},"Connect MIDI output device (Chrome only)"),Object(n["g"])("div",mt,[Object(n["g"])("button",vt," Channel "+Object(n["m"])(this.midi_channel),1),Object(n["g"])("div",bt,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("div",{key:t},[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:function(e){return ne.change_midi_channel(t)}},"Channel "+Object(n["m"])(t),9,["onClick"])])})),64))])]),yt,this.show_midi_devices?(Object(n["h"])(),Object(n["c"])("p",Ot,Object(n["m"])(this.midi_device_names),1)):Object(n["d"])("",!0),jt,this.phrasebank_loaded?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("p",xt,"Loading phrase bank "+Object(n["m"])(t.n_loaded)+"/"+Object(n["m"])(t.n_songs)+" ... This could take around a minute.",1)),"hst-performance anthem"==this.demo.name?(Object(n["h"])(),Object(n["c"])("p",kt,[Object(n["f"])("Anthem demo: phrase "+Object(n["m"])(this.demo.line)+" bar "+Object(n["m"])(this.demo.bar)+" ",1),this.demo.locked?(Object(n["h"])(),Object(n["c"])("span",wt,"locked")):Object(n["d"])("",!0),this.demo.locked1?(Object(n["h"])(),Object(n["c"])("span",Tt,"locked")):Object(n["d"])("",!0)])):Object(n["d"])("",!0)]),Object(n["g"])("div",Mt,[Object(n["g"])("div",qt,[Object(n["g"])("button",Dt,[Object(n["f"])(Object(n["m"])("Input type: "+this.input_type)+" ",1),It]),Object(n["g"])("ul",St,[Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[22]||(e[22]=function(t){return ne.change_input_type("movable")})},"Movable")]),Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[23]||(e[23]=function(t){return ne.change_input_type("fixed")})},"Fixed")])]),"movable"==this.input_type?(Object(n["h"])(),Object(n["c"])("div",Et,[Object(n["g"])("button",Pt,[Object(n["f"])(Object(n["m"])("Key: "+this.key+" major")+" ",1),At]),Object(n["g"])("ul",Ct,[Object(n["g"])("li",null,[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(this.scales_major,(function(t){return Object(n["h"])(),Object(n["c"])("a",{key:t,class:"dropdown-item",href:"#",onClick:function(e){return ne.change_key(t)}},Object(n["m"])(t+" major"),9,["onClick"])})),128))])])])):Object(n["d"])("",!0),Object(n["g"])("div",Bt,[Object(n["g"])("button",Lt,[Object(n["f"])(Object(n["m"])("Wheel: "+this.wheel.mode)+" ",1),$t]),Object(n["g"])("ul",Ut,[Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[24]||(e[24]=function(t){return ne.change_wheel_input_type("none")})},"None")]),Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[25]||(e[25]=function(t){return ne.change_wheel_input_type("relative")})},"Relative")]),Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[26]||(e[26]=function(t){return ne.change_wheel_input_type("fixed")})},"Fixed")])])])]),this.loaded&&!this.hide_vis_input?(Object(n["h"])(),Object(n["c"])("div",Rt,["fixed"!=t.input_type||this.wheel.connected?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])(ce,{key:0,onUpdate_current_chord:ne.update_current_chord},null,8,["onUpdate_current_chord"])),"movable"!=t.input_type||this.wheel.connected?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])(ae,{key:1,ref:"dial",interface_key:this.key,roots:t.scales_major,onUpdate_current_chord:ne.update_current_chord},null,8,["interface_key","roots","onUpdate_current_chord"])),"relative"==this.wheel.mode&&this.wheel.connected?(Object(n["h"])(),Object(n["c"])(oe,{key:2,ref:"dial_wheel",interface_key:this.key,roots:t.scales_major,onUpdate_current_chord:ne.update_current_chord},null,8,["interface_key","roots","onUpdate_current_chord"])):Object(n["d"])("",!0),"fixed"==this.wheel.mode&&this.wheel.connected?(Object(n["h"])(),Object(n["c"])(le,{key:3,ref:"dial_wheel",interface_key:this.key,roots:t.scales_major,onUpdate_current_chord:ne.update_current_chord},null,8,["interface_key","roots","onUpdate_current_chord"])):Object(n["d"])("",!0)])):Object(n["d"])("",!0)]),Object(n["g"])("div",Ft,[zt,"none"!=this.demo.name||this.wheel.connected?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])(he,{key:0,onSet_filter:ne.set_filter},null,8,["onSet_filter"])),"none"==this.demo.name&&this.wheel.connected?(Object(n["h"])(),Object(n["c"])(de,{key:1,ref:"phrase_filter_wheel",onSet_filter:ne.set_filter},null,8,["onSet_filter"])):Object(n["d"])("",!0),"none"!=this.demo.name?(Object(n["h"])(),Object(n["c"])(_e,{key:2,ref:"phrase_selector_demo",noteseqs:this.next_phrases,onUpdate_next_phrase:ne.update_next_phrase},null,8,["noteseqs","onUpdate_next_phrase"])):Object(n["d"])("",!0),"none"!=this.demo.name||this.wheel.connected?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])(ue,{key:3,ref:"phrase_selector",noteseqs:this.next_phrases,onUpdate_next_phrase:ne.update_next_phrase},null,8,["noteseqs","onUpdate_next_phrase"])),"none"==this.demo.name&&this.wheel.connected?(Object(n["h"])(),Object(n["c"])(ue,{key:4,id:"phrase_select_wheel",ref:"phrase_selector",noteseqs:this.next_phrases,onUpdate_next_phrase:ne.update_next_phrase},null,8,["noteseqs","onUpdate_next_phrase"])):Object(n["d"])("",!0)])])])])])]),Kt,Nt,Ht,Object(n["g"])(pe,{noteSequence:this.original_noteseq,"sound-font":"",visualizer:"#original_vis",id:"original_player"},null,8,["noteSequence"]),Object(n["g"])("div",Xt,[Object(n["g"])("div",Vt,[Object(n["g"])("div",Yt,[Object(n["g"])("input",{type:"checkbox",id:"root_overlay",checked:t.mel,onClick:e[27]||(e[27]=function(t){return ie.mel_on_click()})},null,8,["checked"]),Wt,Jt])]),Object(n["g"])("div",Gt,[Object(n["g"])("div",Zt,[Object(n["g"])("input",{type:"checkbox",id:"chord_overlay",checked:t.acc,onClick:e[28]||(e[28]=function(t){return ie.acc_on_click()})},null,8,["checked"]),Qt,te])])])])}var re=r("b85c"),ne=r("3835"),ie=(r("cb29"),r("caad"),r("2532"),r("a15b"),r("99af"),r("ac1f"),r("5319"),r("159b"),r("3db6")),se=Object(n["q"])("data-v-0c3b6279");Object(n["j"])("data-v-0c3b6279");var ce=Object(n["g"])("p",null,"Current chord:",-1),ae={id:"root_table",class:"table table-bordered table-fixed"};Object(n["i"])();var oe=se((function(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])("div",null,[ce,Object(n["g"])("p",{id:"current_chord_text",class:{text_major:"M"==t.current_chord_type,text_minor:"m"==t.current_chord_type,text_dom:"D"==t.current_chord_type}},Object(n["m"])(c.current_chord_text),3),Object(n["g"])("table",ae,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(12,(function(e){return Object(n["g"])("td",{key:e,id:"root_"+e,onClick:function(t){return c.root_on_click(e-1,t)},onContextmenu:Object(n["p"])((function(t){return c.root_on_rightclick(e-1,t)}),["prevent"]),onMouseup:Object(n["p"])((function(t){return c.root_on_middleclick(e-1,t)}),["middle"]),class:{root_cell:!0,root_black:[1,3,6,8,10].includes(e-1),major:"M"==t.current_chord_type&&t.current_chord_root==e-1,minor:"m"==t.current_chord_type&&t.current_chord_root==e-1,dom:"D"==t.current_chord_type&&t.current_chord_root==e-1}},Object(n["m"])(t.roots[e-1]),43,["id","onClick","onContextmenu","onMouseup"])})),64))])])])])})),le={name:"InterfaceFixed",data:function(){return{roots:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3}},computed:{current_chord_text:function(){return 3==this.current_chord_interval?"M"==this.current_chord_type?this.roots[this.current_chord_root]:this.roots[this.current_chord_root]+this.current_chord_type:"D"==this.current_chord_type?this.roots[this.current_chord_root]+this.current_chord_interval:"M"==this.current_chord_type?this.roots[this.current_chord_root]+"maj"+this.current_chord_interval:this.roots[this.current_chord_root]+this.current_chord_type+this.current_chord_interval}},methods:{root_on_click:function(t,e){e.ctrlKey?this.root_on_rightclick(t,e):(this.current_chord_root=t,this.current_chord_type="M",e.altKey?this.current_chord_interval=7:e.shiftKey&&void 0!=e.movementX?(this.current_chord_type="D",this.current_chord_interval=7):this.current_chord_interval=3,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text))},root_on_rightclick:function(t,e){this.current_chord_root=t,this.current_chord_type="m",this.current_chord_interval=3,e.altKey?this.current_chord_interval=7:this.current_chord_interval=3,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text)},root_on_middleclick:function(t){this.current_chord_root=t,this.current_chord_type="D",this.current_chord_interval=7,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text)},keyboard_functions:function(t){var e=t.key;if(["!","@","#","$","%","^","&","*","(",")","_","+"].includes(e)){t.preventDefault();var r=["!","@","#","$","%","^","&","*","(",")","_","+"].indexOf(e);this.root_on_click(r,t)}else if(["⁄","€","‹","›","ﬁ","ﬂ","‡","°","·","—","±"].includes(e)){t.preventDefault();var n=["⁄","€","‹","›","ﬁ","ﬂ","‡","°","·","—","±"].indexOf(e);this.root_on_click(n,t)}else if(["1","2","3","4","5","6","7","8","9","0","-","="].includes(e)&&t.ctrlKey){t.preventDefault();var i=["1","2","3","4","5","6","7","8","9","0","-","="].indexOf(e);this.root_on_rightclick(i,t)}else if(["1","2","3","4","5","6","7","8","9","0","-","="].includes(e)&&t.altKey){t.preventDefault();var s=["1","2","3","4","5","6","7","8","9","0","-","="].indexOf(e);this.root_on_middleclick(s,t)}else if(["¡","™","£","¢","∞","§","¶","•","ª","º","–","≠"].includes(e)){t.preventDefault();var c=["¡","™","£","¢","∞","§","¶","•","ª","º","–","≠"].indexOf(e);this.root_on_middleclick(c,t)}}},mounted:function(){document.addEventListener("keydown",this.keyboard_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keyboard_functions)}};r("dc1a");le.render=oe,le.__scopeId="data-v-0c3b6279";var he=le,de=Object(n["g"])("svg",{id:"dial_svg"},null,-1);function _e(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])("div",null,[de])}var ue=r("5698"),pe=r("772f"),fe=pe.Note,ge=pe.Scale;console.log(fe,ge);var me={name:"InterfaceMovable",props:{interface_key:String,roots:Array},data:function(){return{major_scale:[0,2,4,5,7,9,11],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3,dial_r_outer:100,degree_text:["I","ii","iii","IV","V","vi","vii°"],alt:!1,ctrl:!1,shift:!1,s:!1,z:!1,x:!1}},computed:{interface_key_idx:function(){return this.roots.indexOf(this.interface_key)},dial_r_center:function(){return this.dial_r_outer/2},dial_r_degrees:function(){return 1.5*this.dial_r_outer},scale_roots:function(){return ge.get(this.interface_key+" major").notes}},methods:{outer_text:function(t){for(var e=ge.get(t+" major").notes,r=0;r<3;r++)e[[1,2,5][r]]+="m";return e[6]+="dim",e},draw_dial:function(t){var e=this;ue.selectAll("g").remove().exit();for(var r=ue.select("#dial_svg").append("g").attr("class","g").attr("transform","translate("+(this.dial_r_degrees+5)+","+(this.dial_r_degrees+5)+")"),n=this,i=function(i){var s=ue.arc().innerRadius(e.dial_r_center).outerRadius(e.dial_r_outer).startAngle(2*i*Math.PI/t.length).endAngle(2*(i+1)*Math.PI/t.length);r.append("path").attr("d",s).attr("id","outer_path"+i).attr("class","outer_path").on("click",(function(){n.outer_on_click(i)})).on("contextmenu",(function(t){t.preventDefault(),n.outer_on_click(i)})).on("mouseover",(function(){ue.select("#outer_path"+i).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){ue.select("#outer_path"+i).classed("outer_path_mouseover",!1)})),r.append("text").attr("dx",(e.dial_r_outer+e.dial_r_center)/2*Math.cos(2*i*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("dy",(e.dial_r_outer+e.dial_r_center)/2*Math.sin(2*i*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("class","outer_text").attr("id","outer_text"+i).text(t[i]).on("click",(function(){n.outer_on_click(i)})).on("contextmenu",(function(t){t.preventDefault(),n.outer_on_click(i)})).on("mouseover",(function(){ue.select("#outer_path"+i).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){ue.select("#outer_path"+i).classed("outer_path_mouseover",!1)})),r.append("text").attr("dx",(e.dial_r_outer+e.dial_r_degrees)/2*Math.cos(2*i*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("dy",(e.dial_r_outer+e.dial_r_degrees)/2*Math.sin(2*i*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("class","outer_text").text(e.degree_text[i])},s=0;s<t.length;s++)i(s);r.append("circle").attr("x",0).attr("y",0).attr("r",this.dial_r_center).attr("class","center_path"),r.append("text").attr("class","center_text").attr("id","center_text").text("")},get_current_chord_text:function(t){return 3==this.current_chord_interval?"sdM"==this.current_chord_type?t:"sdm"==this.current_chord_type?t+"m":"xdM"==this.current_chord_type?t:"xdm"==this.current_chord_type?t+"m":"M"==this.current_chord_type?t:t+this.current_chord_type:"D"==this.current_chord_type?t+this.current_chord_interval:"M"==this.current_chord_type?t+"maj"+this.current_chord_interval:t+this.current_chord_type+this.current_chord_interval},update_center_text:function(t){var e=ue.select("#center_text");e.text(t),e.classed("text_major",!1),e.classed("text_minor",!1),e.classed("text_dom",!1),"M"==this.current_chord_type&&ue.select("#center_text").classed("text_major",!0),"m"==this.current_chord_type&&e.classed("text_minor",!0),"D"==this.current_chord_type&&e.classed("text_dom",!0)},outer_on_click:function(t){this.current_chord_root=(this.major_scale[t]+this.roots.indexOf(this.interface_key))%12;var e=this.scale_roots[t];this.s&&(this.current_chord_root=(this.current_chord_root+7)%12,e=this.scale_roots[(t+4)%7],6==t&&(2==e.length&&"b"==e.charAt(1)?e=e.charAt(0):e+="#"),this.current_chord_interval=7,this.current_chord_type="D"),this.alt?(this.current_chord_interval=7,this.current_chord_type="D",this.shift?this.current_chord_type="M":this.ctrl&&(console.log("CTRL"),this.current_chord_type="m")):this.shift?(this.current_chord_interval=3,this.current_chord_type="M"):this.ctrl?(this.current_chord_interval=3,this.current_chord_type="m"):this.s||(this.current_chord_interval=3,[0,3,4].includes(t)?this.current_chord_type="M":this.current_chord_type="m"),this.z&&(this.current_chord_type="sd"+this.current_chord_type),this.x&&(this.current_chord_type="xd"+this.current_chord_type),this.update_center_text(this.get_current_chord_text(e)),this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.get_current_chord_text(e));for(var r=0;r<7;r++)ue.select("#outer_path"+r).classed("outer_path_active",!1);ue.select("#outer_path"+t).classed("outer_path_active",!0)},keydown_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!0),"Shift"==e&&(t.preventDefault(),this.shift=!0),"Control"==e&&(t.preventDefault(),this.ctrl=!0),["S","s"].includes(e)&&(t.preventDefault(),this.s=!0),["Z","z"].includes(e)&&(t.preventDefault(),this.z=!0),["X","x"].includes(e)&&(t.preventDefault(),this.x=!0),["1","2","3","4","5","6","7"].includes(e)&&(t.preventDefault(),this.outer_on_click(["1","2","3","4","5","6","7"].indexOf(e))),["!","@","#","$","%","^","&"].includes(e)&&(t.preventDefault(),this.outer_on_click(["!","@","#","$","%","^","&"].indexOf(e))),["¡","™","£","¢","∞","§","¶"].includes(e)&&(t.preventDefault(),this.outer_on_click(["¡","™","£","¢","∞","§","¶"].indexOf(e))),["⁄","€","‹","›","ﬁ","ﬂ","‡"].includes(e)&&(t.preventDefault(),this.outer_on_click(["⁄","€","‹","›","ﬁ","ﬂ","‡"].indexOf(e)))},keyup_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!1),"Shift"==e&&(t.preventDefault(),this.shift=!1),"Control"==e&&(t.preventDefault(),this.ctrl=!1),["S","s"].includes(e)&&(t.preventDefault(),this.s=!1),["Z","z"].includes(e)&&(t.preventDefault(),this.z=!1),["X","x"].includes(e)&&(t.preventDefault(),this.x=!1)}},mounted:function(){this.draw_dial(this.outer_text(this.interface_key)),document.addEventListener("keydown",this.keydown_functions),document.addEventListener("keyup",this.keyup_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keydown_functions),document.removeEventListener("keyup",this.keyup_functions)}};r("6d25");me.render=_e;var ve=me,be=Object(n["q"])("data-v-ac833fb6");Object(n["j"])("data-v-ac833fb6");var ye=Object(n["e"])('<svg id="filter_svg" height="200px" width="200px" data-v-ac833fb6></svg><img src="accFilter_icons/vSparse.svg" height="200" width="200" class="filter_icon" id="vSparse" data-v-ac833fb6><img src="accFilter_icons/vDense.svg" height="200" width="200" class="filter_icon" id="vDense" data-v-ac833fb6><img src="accFilter_icons/hSparse.svg" height="200" width="200" class="filter_icon" id="hSparse" data-v-ac833fb6><img src="accFilter_icons/hDense.svg" height="200" width="200" class="filter_icon" id="hDense" data-v-ac833fb6>',5),Oe=Object(n["g"])("br",null,null,-1);Object(n["i"])();var je=be((function(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])(n["a"],null,[ye,Object(n["g"])("button",{class:"btn btn-light up",onClick:e[1]||(e[1]=function(){return c.reset&&c.reset.apply(c,arguments)})},"Reset"),Oe],64)})),xe=r("5698"),ke={name:"PhraseFilter",data:function(){return{x:-1,y:201,filter_h:-1,filter_v:-1}},computed:{},methods:{reset:function(){this.x=-1,this.y=201,xe.selectAll(".circle").remove().exit(),this.set_filter()},set_filter:function(){var t=(this.x-this.x%40)/40,e=4-(this.y-this.y%40)/40;this.x<0&&(t=-1),t==this.filter_h&&e==this.filter_v||(this.filter_h=t,this.filter_v=e,this.$emit("set_filter",[this.filter_h,this.filter_v]))}},mounted:function(){var t=200,e=5,r=2,n=this,i=xe.drag().on("drag",(function(t){var e=document.getElementById("filter_svg").getBoundingClientRect(),r=(t.sourceEvent.clientX-e.x)/.6,i=(t.sourceEvent.clientY-e.y)/.6;r>200&&(r=199),r<0&&(r=1),i>200&&(i=199),i<0&&(i=1),n.x=r,n.y=i,xe.selectAll(".circle").attr("cx",r).attr("cy",i),n.set_filter()})),s=xe.select("#filter_svg");s.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",t).attr("fill","black").attr("opacity",.3),s.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",t).attr("fill","black").attr("opacity",0).classed("background",!0).on("mousedown",(function(t){var e=document.getElementById("filter_svg").getBoundingClientRect();xe.selectAll(".circle").remove().exit(),s.append("circle").attr("cx",(t.clientX-e.x)/.6).attr("cy",(t.clientY-e.y)/.6).attr("r",10).attr("fill","#00a2ff").classed("circle",!0),i(s.selectAll(".circle")),n.x=(t.clientX-e.x)/.6,n.y=(t.clientY-e.y)/.6,n.set_filter()})),i(s.selectAll(".background"));for(var c=1;c<e;c++)s.append("rect").attr("x",c*t/e).attr("y",0).attr("width",r).attr("height",t).attr("fill","white").attr("opacity",.3),s.append("rect").attr("x",0).attr("y",c*t/e).attr("width",t).attr("height",r).attr("fill","white").attr("opacity",.3);xe.selectAll(".background").raise()},beforeUnmount:function(){}};r("306f");ke.render=je,ke.__scopeId="data-v-ac833fb6";var we=ke,Te=Object(n["q"])("data-v-fa5e1bb8");Object(n["j"])("data-v-fa5e1bb8");var Me={class:"up"},qe={id:"phrase_table",class:"table table-bordered table-fixed"};Object(n["i"])();var De=Te((function(t,e,r,i,s,c){var a=Object(n["l"])("midi-visualizer");return Object(n["h"])(),Object(n["c"])("div",Me,[Object(n["g"])("table",qe,[Object(n["g"])("tbody",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(3,(function(e){return Object(n["g"])("tr",{key:e,id:"phrase_"+e,onClick:function(t){return c.phrase_on_click(e-1)},class:{phrase_cell:!0,selected:e-1==t.next_phrase_idx}},[Object(n["g"])("td",null,[Object(n["g"])(a,{type:"piano-roll",id:"vis[i-1]",noteSequence:r.noteseqs[e-1],config:t.cfg},null,8,["noteSequence","config"])])],10,["id","onClick"])})),64))])])])})),Ie={name:"PhraseSelect",props:{noteseqs:Array},data:function(){return{next_phrase_idx:-1,cfg:{noteHeight:2,pixelsPerTimeStep:40,minPitch:35,maxPitch:80,noteSpacing:.5}}},computed:{},methods:{reset:function(){this.next_phrase_idx=-1},phrase_on_click:function(t){this.next_phrase_idx=t,this.$emit("update_next_phrase",t)},keyboard_functions:function(t){var e=t.key;return e}},mounted:function(){document.addEventListener("keydown",this.keyboard_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keyboard_functions)}};r("bd23");Ie.render=De,Ie.__scopeId="data-v-fa5e1bb8";var Se=Ie,Ee=Object(n["q"])("data-v-5c662532");Object(n["j"])("data-v-5c662532");var Pe={id:"phrase_table",class:"table table-bordered table-fixed"};Object(n["i"])();var Ae=Ee((function(t,e,r,i,s,c){var a=Object(n["l"])("midi-visualizer");return Object(n["h"])(),Object(n["c"])("table",Pe,[Object(n["g"])("tbody",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(1,(function(e){return Object(n["g"])("tr",{key:e,id:"phrase_"+e,class:{phrase_cell:!0,selected:e-1==t.next_phrase_idx}},[Object(n["g"])("td",null,[Object(n["g"])(a,{type:"piano-roll",id:"vis[i-1]",noteSequence:r.noteseqs[e-1],config:t.cfg},null,8,["noteSequence","config"])])],10,["id"])})),64))])])})),Ce={name:"PhraseSelectDemo",props:{noteseqs:Array},data:function(){return{next_phrase_idx:-1,cfg:{noteHeight:2,pixelsPerTimeStep:40,minPitch:35,maxPitch:80,noteSpacing:.5}}},computed:{},methods:{reset:function(){this.next_phrase_idx=-1},phrase_on_click:function(t){this.next_phrase_idx=t,this.$emit("update_next_phrase",t)},keyboard_functions:function(t){var e=t.key;return e}},mounted:function(){document.addEventListener("keydown",this.keyboard_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keyboard_functions)}};r("71c1");Ce.render=Ae,Ce.__scopeId="data-v-5c662532";var Be=Ce,Le=Object(n["g"])("svg",{id:"dial_svg"},null,-1);function $e(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])("div",null,[Le])}var Ue=r("5698"),Re=r("772f"),Fe=Re.Note,ze=Re.Scale;console.log(Fe,ze);var Ke={name:"InterfaceMovableWheel",props:{interface_key:String,roots:Array},data:function(){return{major_scale:[0,2,4,5,7,9,11],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3,dial_r_outer:100,degree_text:["I","ii","iii","IV","V","vi","vii°"],alt:!1,ctrl:!1,shift:!1,s:!1,offset:0}},computed:{interface_key_idx:function(){return this.roots.indexOf(this.interface_key)},dial_r_center:function(){return this.dial_r_outer/2},dial_r_degrees:function(){return 1.5*this.dial_r_outer},scale_roots:function(){return ze.get(this.interface_key+" major").notes}},methods:{outer_text:function(t){for(var e=ze.get(t+" major").notes,r=0;r<3;r++)e[[1,2,5][r]]+="m";return e[6]+="dim",e},draw_dial:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset=(this.offset+r)%7,r=this.offset,Ue.selectAll("g").remove().exit();for(var n=Ue.select("#dial_svg").append("g").attr("class","g").attr("transform","translate("+(this.dial_r_degrees+5)+","+(this.dial_r_degrees+5)+")"),i=this,s=function(s){var c=Ue.arc().innerRadius(e.dial_r_center).outerRadius(e.dial_r_outer).startAngle((s-r+7)%7*2*Math.PI/t.length-Math.PI/t.length).endAngle(2*((s-r+7)%7+1)*Math.PI/t.length-Math.PI/t.length);n.append("path").attr("d",c).attr("id","outer_path"+s).attr("class","outer_path").on("click",(function(){i.outer_on_click(s)})).on("contextmenu",(function(t){t.preventDefault(),i.outer_on_click(s)})).on("mouseover",(function(){Ue.select("#outer_path"+s).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Ue.select("#outer_path"+s).classed("outer_path_mouseover",!1)})),n.append("text").attr("dx",(e.dial_r_outer+e.dial_r_center)/2*Math.cos((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("dy",(e.dial_r_outer+e.dial_r_center)/2*Math.sin((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("class","outer_text").attr("id","outer_text"+s).text(t[s]).on("click",(function(){i.outer_on_click(s)})).on("contextmenu",(function(t){t.preventDefault(),i.outer_on_click(s)})).on("mouseover",(function(){Ue.select("#outer_path"+s).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Ue.select("#outer_path"+s).classed("outer_path_mouseover",!1)})),n.append("text").attr("dx",(e.dial_r_outer+e.dial_r_degrees)/2*Math.cos((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("dy",(e.dial_r_outer+e.dial_r_degrees)/2*Math.sin((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("class","outer_text").text(e.degree_text[s])},c=0;c<t.length;c++)s(c);n.append("circle").attr("x",0).attr("y",0).attr("r",this.dial_r_center).attr("class","center_path"),n.append("text").attr("class","center_text").attr("id","center_text").text("")},get_current_chord_text:function(t){return 3==this.current_chord_interval?"M"==this.current_chord_type?t:t+this.current_chord_type:"D"==this.current_chord_type?t+this.current_chord_interval:"M"==this.current_chord_type?t+"maj"+this.current_chord_interval:t+this.current_chord_type+this.current_chord_interval},update_center_text:function(t){var e=Ue.select("#center_text");e.text(t),e.classed("text_major",!1),e.classed("text_minor",!1),e.classed("text_dom",!1),"M"==this.current_chord_type&&Ue.select("#center_text").classed("text_major",!0),"m"==this.current_chord_type&&e.classed("text_minor",!0),"D"==this.current_chord_type&&e.classed("text_dom",!0)},outer_on_click:function(t,e){t=(t+this.offset+7)%7,console.log(t),this.current_chord_root=(this.major_scale[t]+this.roots.indexOf(this.interface_key))%12;var r=this.scale_roots[t];this.s&&(this.current_chord_root=(this.current_chord_root+7)%12,r=this.scale_roots[(t+4)%7],6==t&&(2==r.length&&"b"==r.charAt(1)?r=r.charAt(0):r+="#"),this.current_chord_interval=7,this.current_chord_type="D"),this.alt?(this.current_chord_interval=7,this.current_chord_type="D",this.shift?this.current_chord_type="M":this.ctrl&&(this.current_chord_type="m")):this.shift?(this.current_chord_interval=3,this.current_chord_type="M"):this.ctrl?(this.current_chord_interval=3,this.current_chord_type="m"):this.s||(this.current_chord_interval=3,[0,3,4].includes(t)?this.current_chord_type="M":this.current_chord_type="m"),this.update_center_text(this.get_current_chord_text(r)),e||this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.get_current_chord_text(r));for(var n=0;n<7;n++)Ue.select("#outer_path"+n).classed("outer_path_active",!1);Ue.select("#outer_path"+t).classed("outer_path_active",!0)},keydown_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!0),"Shift"==e&&(t.preventDefault(),this.shift=!0),"Control"==e&&(t.preventDefault(),this.ctrl=!0),["S","s"].includes(e)&&(t.preventDefault(),this.s=!0),["1","2","3","4","5","6","7"].includes(e)&&(t.preventDefault(),this.outer_on_click(["1","2","3","4","5","6","7"].indexOf(e))),["!","@","#","$","%","^","&"].includes(e)&&(t.preventDefault(),this.outer_on_click(["!","@","#","$","%","^","&"].indexOf(e))),["¡","™","£","¢","∞","§","¶"].includes(e)&&(t.preventDefault(),this.outer_on_click(["¡","™","£","¢","∞","§","¶"].indexOf(e))),["⁄","€","‹","›","ﬁ","ﬂ","‡"].includes(e)&&(t.preventDefault(),this.outer_on_click(["⁄","€","‹","›","ﬁ","ﬂ","‡"].indexOf(e)))},keyup_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!1),"Shift"==e&&(t.preventDefault(),this.shift=!1),"Control"==e&&(t.preventDefault(),this.ctrl=!1),["S","s"].includes(e)&&(t.preventDefault(),this.s=!1)},update_offest:function(t){this.draw_dial(this.outer_text(this.interface_key),t),this.outer_on_click(t,!0)}},mounted:function(){this.draw_dial(this.outer_text(this.interface_key)),document.addEventListener("keydown",this.keydown_functions),document.addEventListener("keyup",this.keyup_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keydown_functions),document.removeEventListener("keyup",this.keyup_functions)}};r("6c4a");Ke.render=$e;var Ne=Ke,He=Object(n["g"])("svg",{id:"dial_svg"},null,-1);function Xe(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])("div",null,[He])}var Ve=r("5698"),Ye=r("772f"),We=Ye.Note,Je=Ye.Scale;console.log(We,Je);var Ge={name:"InterfaceMovableWheelFixed",props:{interface_key:String,roots:Array},data:function(){return{major_scale:[0,2,4,5,7,9,11],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3,dial_r_outer:100,degree_text:["I","ii","iii","IV","V","vi","vii°"],alt:!1,ctrl:!1,shift:!1,s:!1,offset:0}},computed:{interface_key_idx:function(){return this.roots.indexOf(this.interface_key)},dial_r_center:function(){return this.dial_r_outer/2},dial_r_degrees:function(){return 1.5*this.dial_r_outer},scale_roots:function(){return Je.get(this.interface_key+" major").notes}},methods:{outer_text:function(t){for(var e=Je.get(t+" major").notes,r=0;r<3;r++)e[[1,2,5][r]]+="m";return e[6]+="dim",e},draw_dial:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.offset=(this.offset+r)%7,r=this.offset,Ve.selectAll("g").remove().exit();for(var n=Ve.select("#dial_svg").append("g").attr("class","g").attr("transform","translate("+(this.dial_r_degrees+5)+","+(this.dial_r_degrees+5)+")"),i=this,s=function(s){var c=Ve.arc().innerRadius(e.dial_r_center).outerRadius(e.dial_r_outer).startAngle((s-r+7)%7*2*Math.PI/t.length-Math.PI/t.length).endAngle(2*((s-r+7)%7+1)*Math.PI/t.length-Math.PI/t.length);n.append("path").attr("d",c).attr("id","outer_path"+s).attr("class","outer_path").on("click",(function(){i.outer_on_click(s)})).on("contextmenu",(function(t){t.preventDefault(),i.outer_on_click(s)})).on("mouseover",(function(){Ve.select("#outer_path"+s).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Ve.select("#outer_path"+s).classed("outer_path_mouseover",!1)})),n.append("text").attr("dx",(e.dial_r_outer+e.dial_r_center)/2*Math.cos((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("dy",(e.dial_r_outer+e.dial_r_center)/2*Math.sin((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("class","outer_text").attr("id","outer_text"+s).text(t[s]).on("click",(function(){i.outer_on_click(s)})).on("contextmenu",(function(t){t.preventDefault(),i.outer_on_click(s)})).on("mouseover",(function(){Ve.select("#outer_path"+s).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Ve.select("#outer_path"+s).classed("outer_path_mouseover",!1)})),n.append("text").attr("dx",(e.dial_r_outer+e.dial_r_degrees)/2*Math.cos((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("dy",(e.dial_r_outer+e.dial_r_degrees)/2*Math.sin((s-r+7)%7*2*Math.PI/t.length+(1/7-.5)*Math.PI-Math.PI/t.length)).attr("class","outer_text").text(e.degree_text[s])},c=0;c<t.length;c++)s(c);n.append("circle").attr("x",0).attr("y",0).attr("r",this.dial_r_center).attr("class","center_path"),n.append("text").attr("class","center_text").attr("id","center_text").text("")},get_current_chord_text:function(t){return 3==this.current_chord_interval?"M"==this.current_chord_type?t:t+this.current_chord_type:"D"==this.current_chord_type?t+this.current_chord_interval:"M"==this.current_chord_type?t+"maj"+this.current_chord_interval:t+this.current_chord_type+this.current_chord_interval},update_center_text:function(t){var e=Ve.select("#center_text");e.text(t),e.classed("text_major",!1),e.classed("text_minor",!1),e.classed("text_dom",!1),"M"==this.current_chord_type&&Ve.select("#center_text").classed("text_major",!0),"m"==this.current_chord_type&&e.classed("text_minor",!0),"D"==this.current_chord_type&&e.classed("text_dom",!0)},outer_on_click:function(t,e){t=(t+this.offset+7)%7,console.log(t),this.current_chord_root=(this.major_scale[t]+this.roots.indexOf(this.interface_key))%12;var r=this.scale_roots[t];this.s&&(this.current_chord_root=(this.current_chord_root+7)%12,r=this.scale_roots[(t+4)%7],6==t&&(2==r.length&&"b"==r.charAt(1)?r=r.charAt(0):r+="#"),this.current_chord_interval=7,this.current_chord_type="D"),this.alt?(this.current_chord_interval=7,this.current_chord_type="D",this.shift?this.current_chord_type="M":this.ctrl&&(this.current_chord_type="m")):this.shift?(this.current_chord_interval=3,this.current_chord_type="M"):this.ctrl?(this.current_chord_interval=3,this.current_chord_type="m"):this.s||(this.current_chord_interval=3,[0,3,4].includes(t)?this.current_chord_type="M":this.current_chord_type="m"),this.update_center_text(this.get_current_chord_text(r)),e||this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.get_current_chord_text(r));for(var n=0;n<7;n++)Ve.select("#outer_path"+n).classed("outer_path_active",!1);Ve.select("#outer_path"+t).classed("outer_path_active",!0)},keydown_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!0),"Shift"==e&&(t.preventDefault(),this.shift=!0),"Control"==e&&(t.preventDefault(),this.ctrl=!0),["S","s"].includes(e)&&(t.preventDefault(),this.s=!0),["1","2","3","4","5","6","7"].includes(e)&&(t.preventDefault(),this.outer_on_click(["1","2","3","4","5","6","7"].indexOf(e))),["!","@","#","$","%","^","&"].includes(e)&&(t.preventDefault(),this.outer_on_click(["!","@","#","$","%","^","&"].indexOf(e))),["¡","™","£","¢","∞","§","¶"].includes(e)&&(t.preventDefault(),this.outer_on_click(["¡","™","£","¢","∞","§","¶"].indexOf(e))),["⁄","€","‹","›","ﬁ","ﬂ","‡"].includes(e)&&(t.preventDefault(),this.outer_on_click(["⁄","€","‹","›","ﬁ","ﬂ","‡"].indexOf(e)))},keyup_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!1),"Shift"==e&&(t.preventDefault(),this.shift=!1),"Control"==e&&(t.preventDefault(),this.ctrl=!1),["S","s"].includes(e)&&(t.preventDefault(),this.s=!1)},update_offest:function(t){this.draw_dial(this.outer_text(this.interface_key),t),this.outer_on_click(t,!0)}},mounted:function(){this.draw_dial(this.outer_text(this.interface_key)),document.addEventListener("keydown",this.keydown_functions),document.addEventListener("keyup",this.keyup_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keydown_functions),document.removeEventListener("keyup",this.keyup_functions)}};r("42c7");Ge.render=Xe;var Ze=Ge,Qe=Object(n["q"])("data-v-5c95fb7e");Object(n["j"])("data-v-5c95fb7e");var tr=Object(n["e"])('<svg id="filter_svg" height="200px" width="300px" data-v-5c95fb7e></svg><img src="accFilter_icons/vSparse.svg" height="300" width="300" class="filter_icon" id="vSparse" data-v-5c95fb7e><img src="accFilter_icons/vDense.svg" height="300" width="300" class="filter_icon" id="vDense" data-v-5c95fb7e><img src="accFilter_icons/hSparse.svg" height="300" width="300" class="filter_icon" id="hSparse" data-v-5c95fb7e><img src="accFilter_icons/hDense.svg" height="300" width="300" class="filter_icon" id="hDense" data-v-5c95fb7e>',5);Object(n["i"])();var er=Qe((function(t,e,r,i,s,c){return Object(n["h"])(),Object(n["c"])("div",null,[tr,Object(n["g"])("button",{class:"btn btn-light up",onClick:e[1]||(e[1]=function(){return c.reset&&c.reset.apply(c,arguments)})},"Reset")])})),rr=r("5698"),nr={name:"PhraseFilterWheel",data:function(){return{x:-1,y:201,filter_h:-1,filter_v:-1}},computed:{},methods:{reset:function(){this.x=-1,this.y=201,rr.selectAll(".circle").remove().exit(),this.set_filter()},set_filter:function(){var t=(this.x-this.x%100)/100,e=1-(this.y-this.y%100)/100;this.x<0&&(t=-1),t==this.filter_h&&e==this.filter_v||(this.filter_h=t,this.filter_v=e,this.$emit("set_filter",[2*this.filter_h,2*this.filter_v]))},set_circle:function(t,e){rr.selectAll(".circle").remove().exit(),rr.select("#filter_svg").append("circle").attr("cx",t).attr("cy",e).attr("r",10).attr("fill","#00a2ff").classed("circle",!0),this.x=t,this.y=e,this.set_filter()}},mounted:function(){var t=300,e=200,r=3,n=2,i=2,s=this,c=rr.drag().on("drag",(function(r){var n=document.getElementById("filter_svg").getBoundingClientRect(),i=(r.sourceEvent.clientX-n.x)/.6,c=(r.sourceEvent.clientY-n.y)/.6;i>t&&(i=t-1),i<0&&(i=1),c>e&&(c=e-1),c<0&&(c=1),s.x=i,s.y=c,rr.selectAll(".circle").attr("cx",i).attr("cy",c),s.set_filter()})),a=rr.select("#filter_svg");a.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",e).attr("fill","black").attr("opacity",.3),a.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",e).attr("fill","black").attr("opacity",0).classed("background",!0).on("mousedown",(function(t){var e=document.getElementById("filter_svg").getBoundingClientRect();rr.selectAll(".circle").remove().exit(),a.append("circle").attr("cx",(t.clientX-e.x)/.6).attr("cy",(t.clientY-e.y)/.6).attr("r",10).attr("fill","#00a2ff").classed("circle",!0),c(a.selectAll(".circle")),s.x=(t.clientX-e.x)/.6,s.y=(t.clientY-e.y)/.6,s.set_filter()})),c(a.selectAll(".background"));for(var o=1;o<r;o++)a.append("rect").attr("x",o*t/r).attr("y",0).attr("width",i).attr("height",e).attr("fill","white").attr("opacity",.3);for(var l=1;l<n;l++)a.append("rect").attr("x",0).attr("y",l*e/n).attr("width",t).attr("height",i).attr("fill","white").attr("opacity",.3);rr.selectAll(".background").raise()},beforeUnmount:function(){}};r("c1b7");nr.render=er,nr.__scopeId="data-v-5c95fb7e";var ir=nr,sr=r("bc3a").default,cr=r("5698"),ar=r("6078"),or=r("7360"),lr=r("5e54"),hr=r("cdc9"),dr=hr.WebMidi,_r=r("8eed");console.log(or);var ur=new ar.SoundFontPlayer("https://storage.googleapis.com/magentadata/js/soundfonts/sgm_plus"),pr={name:"App",components:{InterfaceFixed:he,InterfaceMovable:ve,PhraseFilter:we,PhraseSelect:Se,PhraseSelectDemo:Be,InterfaceMovableWheel:Ne,InterfaceMovableWheelFixed:Ze,PhraseFilterWheel:ir},data:function(){return{BACKEND_PATH:"",DEBUG:!1,STEP_SIZE:4,scales_major:["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],prog_step_duration:.5,octave_center:48,allData:{},n_songs:0,n_loaded:0,songID:"000",songname:"",songkey:"",songData:{},original_noteseq:0,original_noteseq_mixed:0,original_noteseq_mel:0,original_noteseq_acc:0,original_noteseq_overlay:{notes:[{pitch:30,start:0,end:16}],totalTime:16},empty_noteseq:{notes:[{pitch:30,start:0,end:16}],totalTime:16},original_chd_str:0,original_chd_mat:0,notedic:0,notedic_mixed:0,notedic_mel:0,notedic_acc:0,sustain:[],expressiveness_vel:100,expressiveness_tempo:100,expressiveness_dur:100,altered_noteseq:{notes:[],totalTime:16},altered_noteseqs:[0,0,0,0],altered_chd_str:Array(16).fill(""),altered_chd_mat:Array(16).fill(Array(36).fill(0)),chds:[],test_chd_strs:[],test_chds:[],altered_chd_str_hide:[],test_idx:-1,bpm:60,next_bpm:60,velocity_scale:10,playing:!1,loaded:!1,phrasebank_loaded:!1,hide_vis_input:!1,input_type:"fixed",key:"C",mel:!1,acc:!0,t:0,chord_seq:[],current_chd:"",current_chd_text:"",altered_vis:0,cfg:{noteHeight:4,pixelsPerTimeStep:100,minPitch:20,maxPitch:90,noteSpacing:1},cfg_mel:{noteHeight:4,pixelsPerTimeStep:100,minPitch:20,maxPitch:90,noteSpacing:1,noteRGB:"255,0,0"},root_overlay:!0,chord_overlay:!1,next_phrases_id:[0,0,0],next_phrases:[0,0,0],next_phrase_idx:-1,edge_weights:[],filter_h:-1,filter_v:-1,show_midi_devices:!1,midi_device_names:[],midi_device:0,midi_channel:1,demo:{name:"none",bar:-1,line:0,chord_seq:["1","4","5","5","5","1","x5","1","6","x5","5","s6","2","1","5","1","1","4","5","5","5","1","x5","1"],phrase_seq:["038_B","050_B","000_A","001_A","002_A","003_A","004_A","005_A","005_A"],locked:!0,lock_passed:!1,locked1:!0,tempo_curve:[[13.71,71.42857143],[14.55,80],[15.3,82.19178082],[16.03,83.33333333],[16.75,81.08108108],[17.49,78.94736842],[18.25,83.33333333],[18.97,80],[19.72,84.50704225],[20.43,77.92207792],[21.2,83.33333333],[21.92,81.08108108],[22.66,80],[23.41,83.33333333],[24.13,83.33333333],[24.85,77.92207792],[25.62,83.33333333],[26.34,83.33333333],[27.06,83.33333333],[27.78,82.19178082],[28.51,82.19178082],[29.24,81.08108108],[29.98,81.08108108],[30.72,80],[31.47,75.94936709],[32.26,85.71428571],[32.96,77.92207792],[33.73,84.50704225],[34.44,84.50704225],[35.15,81.08108108],[35.89,75],[36.69,81.08108108],[37.43,81.08108108],[38.17,86.95652174],[38.86,84.50704225],[39.57,83.33333333],[40.29,89.55223881],[40.96,84.50704225],[41.67,80],[42.42,84.50704225],[43.13,83.33333333],[43.85,85.71428571],[44.55,84.50704225],[45.26,85.71428571],[45.96,83.33333333],[46.68,82.19178082],[47.41,76.92307692],[48.19,80],[48.94,77.92207792],[49.71,85.71428571],[50.41,81.08108108],[51.15,77.92207792],[51.92,82.19178082],[52.65,84.50704225],[53.36,81.08108108],[54.1,81.08108108],[54.84,78.94736842],[55.6,81.08108108],[56.34,80],[57.09,78.94736842],[57.85,81.08108108],[58.59,81.08108108],[59.33,84.50704225],[60.04,68.96551724],[60.91,73.17073171],[61.73,81.08108108],[62.47,76.92307692],[63.25,80],[64,73.17073171],[64.82,77.92207792],[65.59,75.94936709],[66.38,81.08108108],[67.12,81.08108108],[67.86,75.94936709],[68.65,77.92207792],[69.42,78.94736842],[70.18,80],[70.93,78.94736842],[71.69,80],[72.44,76.92307692],[73.22,77.92207792],[73.99,81.08108108],[74.73,77.92207792],[75.5,76.92307692],[76.28,80],[77.03,80],[77.78,80],[78.53,77.92207792],[79.3,74.07407407],[80.11,76.92307692],[80.89,82.19178082],[81.62,75],[82.42,80],[83.17,81.08108108],[83.91,76.92307692],[84.69,15.34526854]],sustain:[[.00909090909090909,4],[4.013636363636364,6],[6.013636363636364,7.995454545454545],[8.018181818181818,18],[18.013636363636362,20],[20.009090909090908,23.995454545454546],[24.013636363636362,26],[26.009090909090908,28],[28.013636363636362,34],[34.013636363636365,36],[36.01363636363636,37.99545454545454],[38.01363636363636,44],[44.00909090909091,46],[46.00909090909091,48],[48.01363636363636,51.99545454545454],[52.018181818181816,53],[53.01363636363636,54],[54.00909090909091,55],[55.01363636363636,56],[56.01363636363636,59],[59.01363636363636,60],[60.01363636363636,68],[68.0090909090909,70],[70.01363636363637,71.99545454545454],[72.01818181818182,82.00454545454545],[82.01363636363637,84.00454545454545],[84.01363636363637,88],[88.0090909090909,90],[90.01363636363637,91.99545454545454],[92.01363636363637,95]]},wheel:{enabled:!1,mode:"none",bpm_type:"physical",gas:0,brake:0,acc_ratio:30,clutched:!1,turn_idx:0,wheel_shift:0,wheel_shift_offset:0}}},computed:{},methods:{list_to_noteseq:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,n=[],i=0;i<t.length;i++){var s=t[i][0],c=t[i][1],a=t[i][2];e>=8&&(s+=8,c+=8),s>=e&&s<r&&n.push({pitch:a,startTime:s,endTime:c})}return n},chords_to_noteseq:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=[],n=0;n<t.length;n++){for(var i=t[n],s=[],c=0;c<12;c++)1==i[12+c]&&s.push(c);if(-1==i.slice(0,13).indexOf(1))break;e?r.push([i.slice(0,13).indexOf(1),s,0]):r.push([i.slice(0,13).indexOf(1),s,i.slice(24,36).indexOf(1)])}t=r;var a=[];if(t.length>0){for(var o=t[0],l=this.prog_step_duration,h=1;h<t.length;h++)if(JSON.stringify(t[h])==JSON.stringify(o))l+=this.prog_step_duration;else{for(var d=parseInt(o[0]),_=o[1],u=parseInt(o[2]),p=0;p<_.length;p++)e?a.push({pitch:parseInt(_[p])+d+this.octave_center,startTime:this.prog_step_duration*h-l,endTime:this.prog_step_duration*h}):a.push({pitch:parseInt(_[p])+this.octave_center,startTime:this.prog_step_duration*h-l,endTime:this.prog_step_duration*h});a.push({pitch:u+d+this.octave_center-12,startTime:this.prog_step_duration*h-l,endTime:this.prog_step_duration*h}),o=t[h],l=this.prog_step_duration}for(var f=parseInt(o[0]),g=o[1],m=parseInt(o[2]),v=0;v<g.length;v++)e?a.push({pitch:parseInt(g[v])+f+this.octave_center,startTime:this.prog_step_duration*t.length-l,endTime:this.prog_step_duration*t.length}):a.push({pitch:parseInt(g[v])+this.octave_center,startTime:this.prog_step_duration*t.length-l,endTime:this.prog_step_duration*t.length});return a.push({pitch:m+f+this.octave_center-12,startTime:this.prog_step_duration*t.length-l,endTime:this.prog_step_duration*t.length}),{notes:a,totalTime:this.prog_step_duration*t.length}}},get_songdata:function(){var t=this,e=this.BACKEND_PATH;this.DEBUG&&(e="http://127.0.0.1:5000"),sr.get(e+"/get_songdata").then((function(e){var r=e.data;r.songData||(r=JSON.parse(e.data)),t.songData=r.songData}))},get_data:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"000",r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("string"!=typeof e&&(e=void 0!=e.target.dataset.song?e.target.dataset.song.slice(0,3)+"_"+e.target.dataset.segment:"000"),"000"==e){var n=Object.keys(this.allData).slice(1);e=n[Math.floor(Math.random()*n.length)]}"none"!=this.demo.name&&(e=this.demo.phrase_seq[this.demo.line]);var i=this.allData[e];this.songID=i.songID,this.original_noteseq_mixed=i.original_noteseq_mixed,this.original_noteseq_mel=i.original_noteseq_mel,this.original_noteseq_acc=i.original_noteseq_acc,this.original_chd_str=i.original_chd_str,this.original_chd_mat=i.original_chd_mat,this.notedic_mixed=i.notedic_mixed,this.notedic_mel=i.notedic_mel,this.notedic_acc=i.notedic_acc,this.sustain=i.sustain,this.songname=i.name,this.songkey=i.key,this.update_melacc_toggle();for(var s=1;s<4;s++)for(var c=0;c<this.sustain.length;c++){var a=this.sustain[c][0],o=this.sustain[c][1];if(a<4*s&&o>4*s)break;if(a>4*s){c>0?this.sustain[c-1][1]=4*s+1:this.sustain.push([4*s-1,4*s+1]);break}}this.altered_vis=new ar.PianoRollCanvasVisualizer({notes:[{pitch:30,start:0,end:8}],totalTime:16},document.getElementById("altered_canvas"),this.cfg),this.update_overlay(),this.test_show_answer(),r&&this.player_reset(),this.place_barlines_and_player(),setTimeout((function(){t.place_barlines_and_player()}),1e3),setTimeout((function(){t.place_barlines_and_player()}),3e3),"hst-performance anthem"==this.demo.name?this.update_next_phrases_demo():this.update_next_phrases()},get_data_all:function(){var t=this,e=0,r=this.BACKEND_PATH;this.DEBUG&&(r="http://127.0.0.1:5000"),sr.get(r+"/get_data_all").then((function(n){var i=n.data;i[0]>0||(i=JSON.parse(n.data)),t.allData={edge_weights:i[1][1]},t.edge_weights=i[1][1],e=i[0],t.DEBUG&&(e=1),t.n_songs=e;for(var s=0;s<e;s++)t.DEBUG?sr.get(r+"/get_data_all_idx",{params:{idx:5}}).then((function(r){t.n_loaded++;var n=r.data;0!=n[0]&&(n=JSON.parse(r.data));var i=n[1][0],s=n[1][1];t.allData[i]=s,Object.keys(t.allData).length==e+1&&(t.get_data(),t.phrasebank_loaded=!0,t.apply_filter_anchors())})):sr.get(r+"/get_data_all_idx",{params:{idx:s}}).then((function(r){t.n_loaded++;var n=r.data;0!=n[0]&&(n=JSON.parse(r.data));var i=n[1][0],s=n[1][1];t.allData[i]=s,Object.keys(t.allData).length==e+1&&(t.get_data(),t.phrasebank_loaded=!0,t.apply_filter_anchors())}))}))},get_data_anthem:function(){var t=this,e=0,r=this.BACKEND_PATH;sr.get(r+"/get_data_anthem").then((function(n){var i=n.data;i[0]>0||(i=JSON.parse(n.data)),t.allData={edge_weights:i[1][1]},t.edge_weights=i[1][1],e=i[0],t.n_songs=e;for(var s=0;s<e;s++)sr.get(r+"/get_data_anthem_idx",{params:{idx:s}}).then((function(r){t.n_loaded++;var n=r.data;0!=n[0]&&(n=JSON.parse(r.data));var i=n[1][0],s=n[1][1];t.allData[i]=s,Object.keys(t.allData).length==e+1&&(t.get_data(),t.phrasebank_loaded=!0)}))}))},player_play:function(){if(this.loaded&&this.playing){if(this.t%this.STEP_SIZE==0&&(0==this.t&&-1!=this.next_phrase_idx&&(this.get_data(this.next_phrases_id[this.next_phrase_idx],!1),this.next_phrase_idx=-1,"hst-performance anthem"==this.demo.name?this.update_next_phrases_demo():(this.update_next_phrases(),this.$refs.phrase_selector.reset())),this.player_query_step()),!this.playing)return;this.t+=4,16==this.t&&(this.t=0,!this.demo.locked&&!this.demo.locked1&&this.demo.line<this.demo.phrase_seq.length-1&&(this.demo.line++,this.next_phrase_idx=0),this.demo.locked||!this.demo.locked1||this.demo.lock_passed||(this.demo.lock_passed=!0,this.demo.line++,this.next_phrase_idx=0))}},player_reset:function(){this.playing=!1,this.loaded=!0,this.t=0,this.altered_noteseq.notes=[],this.altered_noteseqs=[0,0,0,0],this.chord_seq=[],this.altered_chd_str=Array(16).fill(""),this.altered_chd_mat=Array(16).fill(Array(36).fill(0)),this.altered_vis.redraw(),this.update_overlay()},player_query_step:function(){var t=this;if("none"!=this.demo.name&&this.demo.line>1){if(this.demo.bar>=this.demo.chord_seq.length)return void(this.playing=!1);this.demo.bar++,""==this.current_chd&&(this.demo.chord_seq[this.demo.bar].includes("s")?(this.$refs.dial.keydown_functions(new KeyboardEvent("keydown",{key:"z"})),this.$refs.dial.keydown_functions(new KeyboardEvent("keydown",{key:this.demo.chord_seq[this.demo.bar].slice(1)})),this.$refs.dial.keyup_functions(new KeyboardEvent("keydown",{key:"z"}))):this.demo.chord_seq[this.demo.bar].includes("x")?(this.$refs.dial.keydown_functions(new KeyboardEvent("keydown",{key:"x"})),this.$refs.dial.keydown_functions(new KeyboardEvent("keydown",{key:this.demo.chord_seq[this.demo.bar].slice(1)})),this.$refs.dial.keyup_functions(new KeyboardEvent("keydown",{key:"x"}))):this.$refs.dial.keydown_functions(new KeyboardEvent("keydown",{key:this.demo.chord_seq[this.demo.bar]})))}if(""!=this.current_chd){this.playing=!0;var e,r=[];if(this.demo.bar>-1){var n=this.demo.tempo_curve.slice(4*this.demo.bar,4*this.demo.bar+4);e=n[3][0]-n[0][0]+60/n[3][1];for(var i=0;i<4;i++)r[i]=[n[i][0]-n[0][0]+.001,n[i][1]]}else{var s=this.get_tempo_changes(),c=Object(ne["a"])(s,2);r=c[0],e=c[1]}setTimeout((function(){t.player_play()}),1e3*e);for(var a=this.t;a<this.t+4;a++)this.highlight_cell("altered"+a,e);var o=function r(n){t.highlight_cell("time_altered"+n,e/4),n%4!=3&&setTimeout((function(){r(n+1)}),250*e)};o(this.t),this.bpm=this.next_bpm,0==this.t&&(this.altered_chd_str=Array(16).fill(""),this.altered_chd_mat=Array(16).fill(Array(36).fill(0)),this.altered_noteseq.notes=[],this.altered_noteseqs=[0,0,0,0],this.chds=[]),this.t%this.STEP_SIZE==0&&(this.chord_seq=[]),this.chds.push(this.current_chd),this.chord_seq.push(this.current_chd);var l=parseInt(this.current_chd.slice(0,-2)),h=this.current_chd.slice(-2);this.altered_chd_str[this.t]=this.current_chd_text,this.wheel.clutched&&this.wheel.connected||(this.current_chd="",this.current_chd_text="");for(var d=8/this.STEP_SIZE,_=[],u=0;u<this.chord_seq.length;u++)_.push(this.chord_seq[u]);while(_.length<d)_.push(_[_.length-1]);_=_.join(",");var p=this.notedic[(this.t-this.t%8)/8][_],f=this.list_to_noteseq(p,this.t,this.t+this.STEP_SIZE,!0);f=this.apply_dynamics(f),this.altered_noteseq.notes=this.altered_noteseq.notes.concat(f);var g=this.notes_to_quant_noteseq(f),m=Object(ie["unquantizeSequence"])(g),v=this;if(v.demo.bar>=0)for(var b=0;b<m.notes.length;b++)for(var y=0;y<v.demo.sustain.length;y++){var O=v.demo.sustain[y][0]-16*(v.demo.line-2),j=v.demo.sustain[y][1]-16*(v.demo.line-2);if(m.notes[b].endTime>O&&m.notes[b].endTime<j){m.notes[b].endTime=j;break}if(m.notes[b].endTime<O)break}for(var x=0;x<m.notes.length;x++){for(var k=0;k<m.notes.length;k++)m.notes[x].startTime<m.notes[k].startTime&&m.notes[x].endTime>=m.notes[k].startTime&&m.notes[x].pitch==m.notes[k].pitch&&(m.notes[x].endTime=m.notes[k].startTime-.15);m.notes[x].endTime>=3.9&&(m.notes[x].endTime=5)}lr.Transport.bpm.setValueAtTime(60,lr.Transport.now());for(var w=0;w<r.length;w++)lr.Transport.bpm.setValueAtTime(r[w][1],lr.Transport.now()+r[w][0]);ur.isPlaying()&&ur.stop(),m.totalTime=6,ur.start(m),this.altered_noteseqs[(this.t-this.t%4)/4]=this.altered_noteseq,this.hide_vis_input||(this.altered_vis.noteSequence=this.altered_noteseq,this.altered_vis.redraw()),(this.current_chd.includes("sd")||this.current_chd.includes("xd"))&&(l=parseInt(this.current_chd.slice(0,-4)),h=this.current_chd.slice(-2));var T=Array(36).fill(0);T[l]=1,T[24]=1;var M=[0,4,7],q=[0,3,7],D=[0,4,7,11],I=[0,3,7,10],S=[0,4,7,10],E=0;"M3"==h&&(E=M),"m3"==h&&(E=q),"M7"==h&&(E=D),"m7"==h&&(E=I),"D7"==h&&(E=S);for(var P=0,A=0;A<12;A++)P+=T[A];0==P&&(T[0]=1);for(var C=0;C<E.length;C++)T[(l+E[C])%12+12]=1;for(var B=this.t;B<this.t+this.STEP_SIZE;B++)this.altered_chd_mat[B]=T;this.update_overlay(),this.wheel.connected&&("relative"==this.wheel.mode&&this.$refs.dial_wheel.update_offest(this.wheel.turn_idx),this.next_bpm=this.bpm+(this.wheel.gas-this.wheel.brake)*this.wheel.acc_ratio,this.wheel.wheel_shift_offset=4-this.wheel.sheel_shift,this.wheel.sheel_shift=0)}else this.playing=!1},notes_to_quant_noteseq:function(t){var e=Object(ie["createQuantizedNoteSequence"])(4,60);e.tempos=[{time:0,qpm:60}];for(var r=this,n=0;n<t.length;n++){var i=t[n],s=i.startTime,c=i.endTime;if(r.demo.bar>=0)for(var a=0;a<r.demo.sustain.length;a++){var o=r.demo.sustain[a][0]-16*(r.demo.line-2),l=r.demo.sustain[a][1]-16*(r.demo.line-2);if(i.endTime>o&&i.endTime<l){c=l;break}if(i.endTime<o)break}else for(var h=0;h<r.sustain.length;h++){var d=r.sustain[h][0],_=r.sustain[h][1];if(i.endTime>d&&i.endTime<_){c=_;break}if(i.endTime<d)break}e.notes.push({pitch:i.pitch,quantizedStartStep:4*(s-this.t),quantizedEndStep:Math.round(4*(c-this.t)),velocity:i.velocity})}for(var u=0;u<e.notes.length;u++)for(var p=0;p<e.notes.length;p++)e.notes[u].quantizedStartStep<e.notes[p].quantizedStartStep&&e.notes[u].quantizedEndStep>e.notes[p].quantizedStartStep&&(e.notes[u].quantizedEndStep=e.notes[p].quantizedStartStep);return e},canvas_update_note:function(t){var e=this.t;0==e&&(e=16);var r={pitch:t.pitch,startTime:t.startTime+e-4,endTime:t.endTime+e-4};t.expressive&&(r={pitch:t.pitch,startTime:t.quant_startTime*this.bpm/60/4+e-4,endTime:t.quant_endTime*this.bpm/60/4+e-4}),this.altered_vis.redraw(r)},apply_dynamics:function(t){var e=this.original_noteseq.notes,r=t;e.sort((function(t,e){return t.startTime-e.startTime})),r.sort((function(t,e){return t.startTime-e.startTime}));for(var n=0,i=0;i<e.length;i++)n+=e[i].velocity;n=Math.floor(n/e.length);for(var s=[],c=[],a=0;a<16;a++)s.push([]),c.push([]);for(var o=0;o<e.length;o++){var l=e[o];l.startTime<this.t||l.startTime>=this.t+4||s[Math.round(l.startTime/.25)%16].push(l.velocity)}for(var h=0;h<r.length;h++){var d=r[h];c[d.startTime/.25%16].push(h)}for(var _=0;_<16;_++)for(var u=c[_],p=s[_],f=0;f<u.length;f++){var g=u[f];if(0==p.length)0==g?r[0].velocity=1:r[g].velocity=r[g-1].velocity;else if(u.length==p.length)r[g].velocity=p[f];else if(f==u.length-1)r[g].velocity=p[p.length-1];else{var m=f/u.length*p.length,v=p[Math.floor(m)],b=p[Math.floor(m)+1],y=m%1;r[g].velocity=v*y+b*(1-y)}}for(var O=0;O<r.length;O++)r[O].velocity=Math.floor(127*((r[O].velocity/n-1)*this.expressiveness_vel/100+1)*this.velocity_scale/100),r[O].velocity>127&&(r[O].velocity=127),r[O].velocity<10&&(r[O].velocity=38);return t},apply_articulation:function(t){var e=this.original_noteseq.notes,r=t.notes;e.sort((function(t,e){return t.startTime-e.startTime})),r.sort((function(t,e){return t.startTime-e.startTime}));for(var n=[],i=[],s=0;s<16;s++)n.push([]),i.push([]);for(var c=0;c<e.length;c++){var a=e[c];a.startTime<this.t||a.startTime>=this.t+4||n[Math.round(a.startTime/.25)%16].push(a.endTime-a.startTime)}for(var o=0;o<r.length;o++){var l=r[o];i[l.startTime/.25%16].push(o)}for(var h=0;h<16;h++)for(var d=i[h],_=n[h],u=0;u<d.length;u++){var p=d[u];if(0!=_.length){var f=r[p].endTime-r[p].startTime;if(d.length==_.length)r[p].endTime=((_[u]/f-1)*this.expressiveness_dur/100+1)*f+r[p].startTime;else if(u==d.length-1)r[p].endTime=((_[_.length-1]/f-1)*this.expressiveness_dur/100+1)*f+r[p].startTime;else{var g=u/d.length*_.length,m=_[Math.floor(g)],v=_[Math.floor(g)+1],b=g%1,y=m*b+v*(1-b);r[p].endTime=((y/f-1)*this.expressiveness_dur/100+1)*f+r[p].startTime}}}for(var O=0;O<r.length;O++)4==r[O].endTime&&(r[O].endTime=8);return t},get_tempo_changes:function(){var t=this.original_noteseq.notes;t.sort((function(t,e){return t.startTime-e.startTime}));for(var e=[],r=[],n=0,i=0;i<65;i++)r.push([]);for(var s=0;s<t.length;s++){var c=t[s];n+=c.velocity,r[Math.round(c.startTime/.25)].push(c.velocity)}for(var a=n/t.length,o=0;o<65;o++){var l=r[o].reduce((function(t,e){return t+e}),0);l<a*r[o].length?e.push([o,!0]):r[o].length>0&&e.push([o,!1])}for(var h=[[.001,this.bpm]],d=0,_=0,u=0,p=this.bpm,f=[-1,-1,-1,-1],g=0;g<e.length;g++){for(var m=e[g][0],v=e[g][1],b=0;b<4;b++)-1==f[b]&&m>16+16*b&&(f[b]=d+15*(16+16*b-_)/p);d+=60*(m-_)/p/4,g==e.length-1&&(f[3]=d+15/p*(64-m)),v?(p/=.015*this.expressiveness_tempo/100+1,u+=1,h.push([d,p,m])):!v&&u>0&&(p*=Math.pow(.015*this.expressiveness_tempo/100+1,u),u=0,h.push([d,p,m])),_=m}for(var y=0;y<4;y++)-1==f[y]&&(f[y]=f[y-1]+240/p);for(var O=[[.001,this.bpm,0]],j=0;j<h.length;j++){var x=Object(ne["a"])(h[j],3),k=x[0],w=x[1],T=x[2];0==this.t?k<f[0]&&.001!=k&&O.push([k,w,T%16]):(k<=f[this.t/4-1]&&(O[0][1]=w),k>f[this.t/4-1]&&k<f[this.t/4]&&(k-=f[this.t/4-1],O.push([k,w,T%16])))}for(var M=3;M>0;M--)f[M]-=f[M-1];O.push([0,this.next_bpm,16]);for(var q=0;q<O.length;q++){var D=O[q][2],I=(this.next_bpm-this.bpm)/this.bpm*(D/16)+1;O[q][1]*=I}for(var S=[],E=0;E<16;E++){for(var P=0,A=0,C=0,B=0,L=0;L<O.length;L++){var $=O[L][2],U=O[L][1];if($<=E&&(P=$,A=U),$>=E){C=$,B=U;break}}if(P==C)S.push(A);else{var R=(E-P)/(C-P);S.push(A*R+(1-R)*B)}}for(var F=[[.001,this.bpm]],z=0,K=1;K<16;K++){var N=F[K-1][1];z+=15/N,F.push([z,S[K]])}return z+=15/S[15],[F,z]},change_input_type:function(t){this.input_type=t},change_key:function(t){this.key=t,this.$refs.dial.draw_dial(this.$refs.dial.outer_text(t))},update_current_chord:function(t,e){if(this.current_chd=t,this.current_chd_text=e,this.playing){var r,n;this.current_chd.includes("sd")||this.current_chd.includes("xd")?(r=parseInt(this.current_chd.slice(0,-4)),n=this.current_chd.slice(-2)):(r=parseInt(this.current_chd.slice(0,-2)),n=this.current_chd.slice(-2));var i=Array(36).fill(0),s=this.t;i[r]=1,i[r+24]=1;var c=[0,4,7],a=[0,3,7],o=[0,4,7,11],l=[0,3,7,10],h=[0,4,7,10],d=0;"M3"==n&&(d=c),"m3"==n&&(d=a),"M7"==n&&(d=o),"m7"==n&&(d=l),"D7"==n&&(d=h);for(var _=0;_<d.length;_++)i[(r+d[_])%12+12]=1;for(var u=s;u<s+this.STEP_SIZE;u++)this.altered_chd_mat[u]=i;this.update_overlay(),this.altered_chd_str[s]=this.current_chd_text}else this.playing=!0,this.player_play()},draw_overlay_bar:function(t,e,r,n){e*=100;while(r<=90)r>=30&&t.append("rect").attr("fill",n).attr("opacity",.3).attr("x",e).attr("y",this.cfg.noteHeight*(this.cfg.maxPitch-r)).attr("width",100).attr("height",4).attr("class","overlay"),r+=12},clear_overlay:function(){cr.selectAll(".overlay").remove().exit()},get_color:function(t){return cr.interpolateSinebow((t/12+.6)%1)},draw_root_overlay:function(){for(var t=0;t<this.original_chd_mat.length;t++){var e=this.original_chd_mat[t],r=e.slice(0,12).indexOf(1);this.draw_overlay_bar(cr.select(".original_svg"),t,r,this.get_color(0)),this.altered_chd_mat[t].slice(0,12).indexOf(1)>=0&&!this.hide_vis_input&&this.draw_overlay_bar(cr.select(".swapped_svg"),t,this.altered_chd_mat[t].slice(0,12).indexOf(1),this.get_color(0))}},draw_chord_overlay:function(){for(var t=0;t<this.original_chd_mat.length;t++)for(var e=this.original_chd_mat[t],r=e.slice(0,12).indexOf(1),n=0;n<12;n++)1==e[12+n]&&this.draw_overlay_bar(cr.select(".original_svg"),t,n,this.get_color((n-r)%12)),1!=this.altered_chd_mat[t][12+n]||this.hide_vis_input||this.draw_overlay_bar(cr.select(".swapped_svg"),t,n,this.get_color((n-this.altered_chd_mat[t].slice(0,12).indexOf(1))%12))},update_overlay:function(){this.clear_overlay(),this.chord_overlay?this.draw_chord_overlay():this.root_overlay&&this.draw_root_overlay()},root_on_click:function(){this.root_overlay?this.root_overlay=!1:this.root_overlay=!0,this.update_overlay()},chord_on_click:function(){this.chord_overlay?this.chord_overlay=!1:this.chord_overlay=!0,this.update_overlay()},draw_barlines_original:function(){cr.selectAll(".barline_original").remove().exit();for(var t=document.getElementById("time0").getBoundingClientRect(),e=document.getElementById("original_prog0").getBoundingClientRect(),r=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,i=t.top+window.pageYOffset||document.documentElement.scrollTop,s=e.bottom+window.pageYOffset||document.documentElement.scrollTop,c=1;c<4;c++)cr.selectAll("#original_barline").append("rect").attr("x",r+4*c*(n-r)).attr("y",i).attr("width",3).attr("height",s-i).attr("class","barline barline_original")},draw_barlines_altered:function(){cr.selectAll(".barline_altered").remove().exit();for(var t=document.getElementById("time_altered0").getBoundingClientRect(),e=document.getElementById("altered10").getBoundingClientRect(),r=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,i=t.top+window.pageYOffset||document.documentElement.scrollTop,s=e.bottom+window.pageYOffset||document.documentElement.scrollTop,c=1;c<4;c++)cr.selectAll("#altered_barline").append("rect").attr("x",r+4*c*(n-r)).attr("y",i).attr("width",3).attr("height",s-i).attr("class","barline barline_altered")},place_player_original:function(){var t=document.getElementById("time15").getBoundingClientRect(),e=document.getElementById("original_prog15").getBoundingClientRect(),r=t.right+window.pageXOffset||document.documentElement.scrollLeft,n=t.top+window.pageYOffset||document.documentElement.scrollTop,i=e.top+window.pageYOffset||document.documentElement.scrollTop;cr.select("#original_player").style("position","absolute").style("left",r+"px").style("top",(n+2.5*i)/3.5+"px").style("-webkit-transform","scale(0.75)").raise()},place_barlines_and_player:function(){this.draw_barlines_original(),this.draw_barlines_altered(),this.place_player_original(),this.place_melacc_toggle()},mel_on_click:function(){this.mel=!this.mel,this.mel||this.acc||(this.acc=!0),this.update_melacc_toggle()},acc_on_click:function(){this.acc=!this.acc,this.acc||this.mel||(this.mel=!0),this.update_melacc_toggle()},update_melacc_toggle:function(){this.mel&&this.acc?(this.notedic=this.notedic_mixed,this.original_noteseq=this.original_noteseq_mixed,this.original_noteseq_overlay=this.original_noteseq_mel):this.mel?(this.notedic=this.notedic_mel,this.original_noteseq=this.original_noteseq_mel,this.original_noteseq_overlay=this.empty_noteseq):(this.notedic=this.notedic_acc,this.original_noteseq=this.original_noteseq_acc,this.original_noteseq_overlay=this.empty_noteseq)},place_melacc_toggle:function(){var t=document.getElementById("time15").getBoundingClientRect(),e=document.getElementById("original_prog15").getBoundingClientRect(),r=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,i=t.top+window.pageYOffset||document.documentElement.scrollTop,s=e.top+window.pageYOffset||document.documentElement.scrollTop;cr.select("#melacc_toggle").style("position","absolute").style("left",n+(n-r)/4+"px").style("top",(1.15*i+s)/2.15+"px").style("-webkit-transform","scale(0.6)").raise()},play_chord:function(t,e){ur.stop();var r=0,n=16;if("original"==t){ur.start(this.chords_to_noteseq([this.original_chd_mat[e]],!1));for(var i=0;i<16;i++){if(""!=document.getElementById("original_prog"+i).innerHTML.replace(/\s/g,"")&&i>e){n=i;break}""!=document.getElementById("original_prog"+i).innerHTML.replace(/\s/g,"")&&(r=i)}for(var s=r;s<n;s++)this.highlight_cell("original_prog"+s,.5)}if("altered"==t){r=e-e%4;for(var c=r;c<r+4;c++)this.highlight_cell("altered"+c,.5);ur.start(this.chords_to_noteseq([this.altered_chd_mat[e]],!1))}},play_prog_original:function(){var t=this;ur.stop(),ur.start(this.chords_to_noteseq(this.original_chd_mat,!1));var e=0,r=function r(){if(e<16){if(t.highlight_cell("time"+e,t.prog_step_duration),""!=document.getElementById("original_prog"+e).innerHTML.replace(/\s/g,"")){for(var n=1,i=e+1;i<16;i++){if(""!=document.getElementById("original_prog"+i).innerHTML.replace(/\s/g,""))break;n++}for(var s=e;s<e+n;s++)t.highlight_cell("original_prog"+s,n*t.prog_step_duration)}e++,setTimeout((function(){r()}),1e3*t.prog_step_duration)}};r()},play_prog_altered:function(){var t=this;ur.stop(),ur.start(this.chords_to_noteseq(this.altered_chd_mat,!1));var e=0,r=function r(){if(e<16){if(e%4==0&&""==t.altered_chd_str[e])return;if(t.highlight_cell("time_altered"+e,t.prog_step_duration),""!=t.altered_chd_str[e])for(var n=e;n<e+4;n++)t.highlight_cell("altered"+n,4*t.prog_step_duration);e++,setTimeout((function(){r()}),1e3*t.prog_step_duration)}};r()},highlight_cell:function(t,e){document.getElementById(t).classList.add("cell_active"),setTimeout((function(){document.getElementById(t).classList.remove("cell_active")}),1e3*e)},replay_bar:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.loaded&&!this.playing||n){var i=this.t,s=(t-t%4)/4;if(0!=this.altered_noteseqs[s]){this.loaded=!1,this.t=4*(s+1),this.altered_noteseqs[s].totalQuantizedSteps=16,ur.isPlaying()&&ur.stop(),ur.start(this.altered_noteseqs[s],this.bpm),setTimeout((function(){ur.isPlaying()||ur.start(e.altered_noteseqs[s],e.bpm)}),5),setTimeout((function(){ur.isPlaying()||ur.start(e.altered_noteseqs[s],e.bpm)}),10),setTimeout((function(){ur.isPlaying()||ur.start(e.altered_noteseqs[s],e.bpm)}),15),setTimeout((function(){ur.isPlaying()||ur.start(e.altered_noteseqs[s],e.bpm)}),30),setTimeout((function(){ur.isPlaying()||ur.start(e.altered_noteseqs[s],e.bpm)}),50);var c=function t(r){e.highlight_cell("time_altered"+r,6e4/e.bpm/1e3),r%4!=3&&setTimeout((function(){t(r+1)}),6e4/e.bpm)};c(this.t-4);for(var a=this.t-4;a<this.t;a++)this.highlight_cell("altered"+a,24e4/this.bpm/1e3);setTimeout((function(){e.t=i,r--,r>0?(ur.isPlaying()&&ur.stop(),e.replay_bar(t+4,r,!0)):e.loaded=!0}),24e4/this.bpm)}else this.loaded=!0}},replay_all:function(){this.replay_bar(2,4)},test_add:function(){0!=this.altered_noteseqs[3]&&(this.test_chd_strs.push(this.altered_chd_str),this.test_chds.push(this.chds))},test_apply:function(){var t=this;if(!this.playing&&0!=this.test_chd_strs.length){var e=Math.floor(Math.random()*this.test_chd_strs.length);this.hide_vis_input=!0,this.altered_chd_str_hide=this.test_chd_strs[e].slice(),this.altered_vis.noteSequence={notes:[{pitch:30,start:0,end:8}],totalTime:16},this.test_idx=e;var r=function r(n){t.update_current_chord(t.test_chds[e][n],t.test_chd_strs[e][4*n]),0==n?setTimeout((function(){r(n+1)}),225e3/t.bpm):n<3&&setTimeout((function(){r(n+1)}),24e4/t.bpm)};this.player_reset(),r(0)}},test_show_answer:function(){this.hide_vis_input&&!this.playing&&(this.hide_vis_input=!1,this.altered_chd_str=this.altered_chd_str_hide.slice(),this.update_overlay(),this.altered_vis.noteSequence=this.altered_noteseq,this.altered_vis.redraw())},test_clear:function(){this.test_chd_strs=[],this.test_chds=[],this.altered_chd_str_hide=[],this.test_idx=-1,this.hide_vis_input=!1},update_next_phrases:function(){if(-1==this.filter_h){for(var t=this.edge_weights.samples,e=0,r=0;r<t.length;r++)if(t[r]==this.songID){e=r;break}for(var n=[],i=0;i<this.edge_weights.mat[e].length;i++)n.push(this.edge_weights.mat[e][i]);for(var s=0;s<3;s++){var c=n.indexOf(Math.max.apply(Math,n));n[c]=-999;var a=t[c];a!=this.songID?(this.next_phrases_id[s]=a,this.next_phrases[s]=this.allData[a].original_noteseq_acc):s--}}else{for(var o={},l=[],h=0;h<this.edge_weights.samples.length;h++){var d=this.allData[this.edge_weights.samples[h]],_=Math.pow(d["hd"]-this.filter_h,2)+Math.pow(d["vd"]-this.filter_v,2);_ in o?o[_].push(h):(o[_]=[h],l.push(_))}var u=0;l.sort();for(var p=0;p<l.length;p++)for(var f=0;f<o[l[p]].length;f++){var g=this.edge_weights.samples[o[l[p]][f]];if(this.next_phrases_id[u]=g,this.next_phrases[u]=this.allData[g].original_noteseq_acc,u++,u>3)return}}},update_next_phrase:function(t){this.next_phrase_idx=t},update_next_phrases_demo:function(){var t=this.demo.phrase_seq[this.demo.line+1];this.next_phrases_id[0]=t,this.next_phrases[0]=this.allData[t].original_noteseq_acc},set_filter:function(t){this.filter_h=t[0],this.filter_v=t[1],this.update_next_phrases()},apply_filter_anchors:function(){for(var t=[],e=[],r=0;r<this.edge_weights.samples.length;r++){var n=this.allData[this.edge_weights.samples[r]];t.push(n["vd"]),e.push(n["hd"])}t.sort(),e.sort();for(var i=[t[6],t[12],t[18],t[24]],s=[e[6],e[12],e[18],e[24]],c=0;c<this.edge_weights.samples.length;c++){for(var a=4,o=4,l=this.allData[this.edge_weights.samples[c]],h=l["vd"],d=l["hd"],_=3;_>=0;_--)h<i[_]&&(a=_),d<s[_]&&(o=_);l["vd"]=a,l["hd"]=o}},connect_midi:function(){var t=this;dr.enable().then((function(){t.midi_device_names=[],t.show_midi_devices=!0,dr.outputs.forEach((function(e){return t.midi_device_names.push(e.name)})),t.midi_device=dr.outputs[1]})).catch((function(t){return alert(t)}))},output_midi:function(t){var e=6e4*(t.endTime-t.startTime)/lr.Transport.bpm.value;e>12e4/lr.Transport.bpm.value&&(e=12e4/lr.Transport.bpm.value),this.show_midi_devices&&this.midi_device.channels[this.midi_channel].playNote(t.pitch,{duration:e,attack:t.velocity/128})},change_midi_channel:function(t){this.midi_channel=t},follow_tempo:function(){this.next_bpm=this.bpm},apply_velo:function(){},apply_wheel_shift:function(){var t=this.wheel.wheel_shift-1;t>-1?this.$refs.phrase_selector.phrase_on_click(t):this.$refs.phrase_selector.reset()},change_wheel_input_type:function(t){this.wheel.mode=t,"none"==t?this.wheel.connected=!1:(this.input_type="movable",this.wheel.connected=!0)}},mounted:function(){var t=this;"none"==this.demo.name&&(this.demo.name=document.querySelector("title").innerHTML,"hst-performance anthem"!=this.demo.name&&(this.demo.name="none")),this.get_songdata(),"hst-performance anthem"==this.demo.name?this.get_data_anthem():this.get_data_all(),ur.loadAllSamples().then((function(){t.loaded=!0,t.altered_noteseq.notes=[]}));var e=this;ur.callbackObject={run:function(t){e.canvas_update_note(t),e.output_midi(t)},stop:function(){}},window.onresize=this.place_barlines_and_player,document.addEventListener("keydown",(function(e){var r=e.key;["e","E"].includes(r)&&t.player_reset(),["n","N"].includes(r)&&t.get_data(),["t","T"].includes(r)&&t.test_apply(),["s","S"].includes(r)&&t.test_show_answer(),["a","A"].includes(r)&&t.test_add(),["r","R"].includes(r)&&t.replay_all(),["l","L"].includes(r)&&t.demo.locked&&(t.demo.locked=!1),["k","K"].includes(r)&&t.demo.locked1&&!t.demo.locked&&(t.demo.locked1=!1),[" "].includes(r)&&e.preventDefault(),["m"].includes(r)&&(console.log("hi"),o.publish("/client",{text:"hi"}),console.log(t.wheel.mode))}));var r={childList:!0,subtree:!0,attributes:!0},n=document.getElementById("original_player").shadowRoot.querySelector(".current-time"),i=document.getElementById("original_player").shadowRoot.querySelector(".controls");function s(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t&&(t.classList.add("time_cell_active"),setTimeout((function(){t.classList.contains("time_cell_active")&&t.classList.remove("time_cell_active")}),1e3*r),!e.classList.contains("table_cell_active"))){e.classList.add("table_cell_active");var n=[e],i=r,s=document.getElementById("original_prog"+(1*n[n.length-1].id.slice(13,15)+1));while(s&&""==s.innerHTML.replace(/\s/g,""))s.classList.add("table_cell_active"),n.push(s),s=document.getElementById("original_prog"+(1*n[n.length-1].id.slice(13,15)+1)),i+=r;setTimeout((function(){while(n.length>0){var t=n.pop();t.classList.contains("table_cell_active")&&t.classList.remove("table_cell_active")}}),1e3*i)}}var c=function(t,e){var r,c=Object(re["a"])(t);try{for(c.s();!(r=c.n()).done;){r.value;if(i.classList.contains("playing")){var a=document.getElementById("time"+1*n.innerHTML.slice(2,4)),o=document.getElementById("original_prog"+1*n.innerHTML.slice(2,4));s(a,o)}}}catch(l){c.e(l)}finally{c.f()}},a=new MutationObserver(c);if(a.observe(i,r),e.wheel.enabled){e.apply_velo();var o=new _r.Client("http://127.0.0.1:8001/");o.subscribe("/messages",(function(t){if(e.wheel.connected=!0,"none"==e.wheel.mode&&e.change_wheel_input_type("relative"),"gas"==t.type&&(e.wheel.gas=t.value,"delta"==e.wheel.bpm_type&&(e.next_bpm=e.bpm+(e.wheel.gas-e.wheel.brake)*e.wheel.acc_ratio)),"brake"==t.type&&(e.wheel.brake=t.value,"delta"==e.wheel.bpm_type&&(e.next_bpm=e.bpm+(e.wheel.gas-e.wheel.brake)*e.wheel.acc_ratio)),"clutch"==t.type&&(e.wheel.clutched=!e.wheel.clutched,e.wheel.clutched?e.playing||"movable"!=e.input_type||e.$refs.dial_wheel.outer_on_click(0):(e.current_chd="",e.current_chd_text="")),"wheel_turn"==t.type&&"movable"==e.input_type&&(e.wheel.turn_idx=t.value,e.$refs.dial_wheel.outer_on_click(t.value)),"shift"==t.type){var r=t.value;1==r&&e.$refs.phrase_filter_wheel.set_circle(50,50),2==r&&e.$refs.phrase_filter_wheel.set_circle(50,150),3==r&&e.$refs.phrase_filter_wheel.set_circle(150,50),4==r&&e.$refs.phrase_filter_wheel.set_circle(150,150),5==r&&e.$refs.phrase_filter_wheel.set_circle(250,50),6==r&&e.$refs.phrase_filter_wheel.set_circle(250,150),0==r&&e.$refs.phrase_filter_wheel.reset()}"wheel_shift"==t.type&&(e.wheel.wheel_shift=(t.value+e.wheel.wheel_shift_offset)%4,e.apply_wheel_shift())}))}}};r("2835");pr.render=ee;var fr=pr;Object(n["b"])(fr).mount("#app")},6:function(t,e){},"6c4a":function(t,e,r){"use strict";r("3811")},"6d25":function(t,e,r){"use strict";r("a1ab")},7:function(t,e){},"71c1":function(t,e,r){"use strict";r("3337")},8:function(t,e){},9:function(t,e){},a1ab:function(t,e,r){},ac5a:function(t,e,r){},ad83:function(t,e,r){},b190:function(t,e,r){},b5d8:function(t,e,r){},bd23:function(t,e,r){"use strict";r("b190")},c1b7:function(t,e,r){"use strict";r("b5d8")},dc1a:function(t,e,r){"use strict";r("3653")}});
//# sourceMappingURL=app.1372d912.js.map