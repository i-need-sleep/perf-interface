(function(t){function e(e){for(var n,s,a=e[0],l=e[1],o=e[2],d=0,_=[];d<a.length;d++)s=a[d],Object.prototype.hasOwnProperty.call(r,s)&&r[s]&&_.push(r[s][0]),r[s]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);h&&h(e);while(_.length)_.shift()();return c.push.apply(c,o||[]),i()}function i(){for(var t,e=0;e<c.length;e++){for(var i=c[e],n=!0,a=1;a<i.length;a++){var l=i[a];0!==r[l]&&(n=!1)}n&&(c.splice(e--,1),t=s(s.s=i[0]))}return t}var n={},r={app:0},c=[];function s(e){if(n[e])return n[e].exports;var i=n[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=t,s.c=n,s.d=function(t,e,i){s.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},s.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,e){if(1&e&&(t=s(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)s.d(i,n,function(e){return t[e]}.bind(null,n));return i},s.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],l=a.push.bind(a);a.push=e,a=a.slice();for(var o=0;o<a.length;o++)e(a[o]);var h=l;c.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},1:function(t,e){},2:function(t,e){},"22f8":function(t,e,i){"use strict";i("32cb")},"2d13":function(t,e,i){},3:function(t,e){},"306f":function(t,e,i){"use strict";i("ac5a")},"32cb":function(t,e,i){},3653:function(t,e,i){},4:function(t,e){},5:function(t,e){},"56d7":function(t,e,i){"use strict";i.r(e);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("7a23"),r=(i("b64b"),i("fb6a"),{class:"navbar navbar-expand-sm bg-light navbar-hover"}),c={class:"collapse navbar-collapse"},s={class:"navbar-nav mr-auto"},a={class:"nav-item dropdown"},l=Object(n["g"])("button",{class:"dropdown-toggle btn",id:"browse_samples","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}," Browse Samples ",-1),o={class:"dropdown-menu"},h={class:"dropdown-item dropdown-toggle"},d={class:"dropdown-menu"},_={key:0},u={class:"navbar-nav"},p={class:"nav-item"},g={class:"btn",disabled:""},f=Object(n["g"])("br",null,null,-1),b=Object(n["g"])("li",{class:"nav-item"},[Object(n["g"])("a",{tabindex:"0",class:"btn",role:"button","data-toggle":"popover","data-trigger":"focus",title:"Help",rel:"popover","data-content":"\n        Playback: <br> \n        <ul>\n          <li>e: reset player</li>\n          <li>r: replay</li>\n          <li>t: test</li>\n          <li>a: a to test</li>\n          <li>s: show answer</li>\n          <li>n: new sample</li>\n        </ul>\n        Input-Fixed: <br> \n        <ul>\n          <li>Mouse</li>\n          <ul>\n            <li>left click: select a major triad</li>\n            <li>right click: select a minor triad</li>\n            <li>middle click or (shift + left click): select a dominant 7th chord</li>\n            <li>alt + left/right click: select a major/minor 7th chord</li>\n          </ul>\n          <li>Keyboard</li>\n          <ul>\n            <li>'1'-'=': select root</li>\n            <li>shift + root: major triad</li>\n            <li>ctrl + root: minor triad</li>\n            <li>alt + root: moninant 7th chord</li>\n            <li>alt+ shift/ctrl + root: major/minor 7th chord</li>\n          </ul>\n        </ul>\n        Input-Movable: <br> \n        <ul>\n          <li>Mouse</li>\n          <ul>\n            <li>left click: select a triad corresponding the the scale degree</li>\n            <li>shift + left click: select a major triad</li>\n            <li>ctrl + left click: select a minor triad</li>\n            <li>alt + left click: select a dominant seventh chord</li>\n            <li>alt + shift/ctrl + left click: select a major/minor seventh chord</li>\n          </ul>\n          <li>Keyboard</li>\n          <ul>\n            <li>1-7: select a triad corresponding the the scale degree</li>\n            <li>shift + 1-7: select a major triad</li>\n            <li>ctrl + 1-7: select a minor triad</li>\n            <li>alt + 1-7: select a dominant seventh chord</li>\n            <li>alt + shift/ctrl + 1-7: select a major/minor seventh chord</li>\n          </ul>\n        </ul>\n        ","data-html":"true"}," Help "),Object(n["g"])("br")],-1),m={class:"container-fluid pt-3 pb-5",id:"main_app"},v={id:"time_steps",class:"table table-fixed prog_table"},y={class:"thead-light"},O=Object(n["g"])("th",{class:"prog_head table_cell"},null,-1),j=Object(n["g"])("th",{class:"time_cell"},null,-1),k=Object(n["g"])("th",{class:"time_cell"},null,-1),x={class:"up"},w=Object(n["g"])("svg",{class:"original_svg svg right",height:"0px"},null,-1),q={class:"up"},T={id:"original_prog",class:"table table-fixed table-striped prog_table"},I=Object(n["g"])("th",null,null,-1),E=Object(n["g"])("th",null,null,-1),S={id:"altered_time_steps",class:"table table-fixed prog_table"},D={class:"thead-light"},M=Object(n["g"])("canvas",{id:"altered_canvas",class:"right"},null,-1),C=Object(n["g"])("svg",{class:"swapped_svg svg right",id:"swapped_svg",height:"0px"},null,-1),P={class:"up"},A={id:"saved_prog",class:"table table-fixed table-striped prog_table"},B={key:0},L={class:"row"},R={class:"col-4"},F=Object(n["g"])("br",null,null,-1),H=Object(n["f"])(" Bpm: "),$={id:"bpm_text"},K={id:"slider_container"},N={class:"input-group-prepend"},U={class:"input-group-text",style:{width:"160px"}},X=Object(n["f"])(),Y=Object(n["g"])("span",null,"   Root overlay",-1),z={class:"input-group-prepend"},Z={class:"input-group-text",style:{width:"160px"}},J=Object(n["f"])(),G=Object(n["g"])("span",null,"   Chord overlay",-1),V=Object(n["g"])("br",null,null,-1),Q=Object(n["g"])("br",null,null,-1),W=Object(n["g"])("br",null,null,-1),tt=Object(n["g"])("br",null,null,-1),et=Object(n["g"])("br",null,null,-1),it={key:0,class:"test_correct no_click"},nt={key:0},rt={key:1,class:"no_click"},ct={key:0},st=Object(n["g"])("br",null,null,-1),at={class:"dropdown"},lt={class:"btn btn-light dropdown-toggle",type:"button",id:"dropdownMenuButton","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"},ot={class:"dropdown-menu","aria-labelledby":"dropdownMenuButton"},ht=Object(n["g"])("br",null,null,-1),dt={key:0},_t=Object(n["g"])("br",null,null,-1),ut={key:1},pt={class:"col-6"},gt={class:"btn-group"},ft={class:"btn btn-light dropdown-toggle",type:"button","data-toggle":"dropdown"},bt=Object(n["g"])("span",{class:"caret"},null,-1),mt={class:"dropdown-menu"},vt={key:0,class:"dropdown"},yt={class:"btn btn-light dropdown-toggle",type:"button","data-toggle":"dropdown"},Ot=Object(n["g"])("span",{class:"caret"},null,-1),jt={class:"dropdown-menu"},kt={key:0},xt={class:"col-1"},wt=Object(n["g"])("p",null,"Next phrase:",-1),qt=Object(n["g"])("svg",{id:"original_barline",class:"barline_svg"},null,-1),Tt=Object(n["g"])("br",null,null,-1),It=Object(n["g"])("svg",{id:"altered_barline",class:"barline_svg"},null,-1),Et={id:"melacc_toggle"},St={class:"input-group-prepend"},Dt={class:"input-group-text",style:{width:"160px"}},Mt=Object(n["f"])(),Ct=Object(n["g"])("span",null,"   Melody",-1),Pt={class:"input-group-prepend"},At={class:"input-group-text",style:{width:"160px"}},Bt=Object(n["f"])(),Lt=Object(n["g"])("span",null,"   Accompaniment",-1);function Rt(t,e,i,Rt,Ft,Ht){var $t=this,Kt=Object(n["l"])("midi-visualizer"),Nt=Object(n["l"])("InterfaceFixed"),Ut=Object(n["l"])("InterfaceMovable"),Xt=Object(n["l"])("PhraseFilter"),Yt=Object(n["l"])("PhraseSelect"),zt=Object(n["l"])("midi-player");return Object(n["h"])(),Object(n["c"])("div",null,[Object(n["g"])("nav",r,[Object(n["g"])("div",c,[Object(n["g"])("ul",s,[Object(n["g"])("li",a,[l,Object(n["g"])("ul",o,[Object(n["g"])("li",{id:"resample",onClick:e[1]||(e[1]=function(){return Ht.get_data&&Ht.get_data.apply(Ht,arguments)})},"Random Phrase"),(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(Object.keys(this.songData),(function(t){return Object(n["h"])(),Object(n["c"])("li",{key:t},[Object(n["g"])("a",h,"Song "+Object(n["m"])(t)+" "+Object(n["m"])($t.songData[t]["key"]),1),Object(n["g"])("ul",d,[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(Object.keys($t.songData[t]),(function(i){return Object(n["h"])(),Object(n["c"])("div",{key:i},["key"!=i?(Object(n["h"])(),Object(n["c"])("div",_,[Object(n["g"])("li",{onClick:e[2]||(e[2]=function(){return Ht.get_data&&Ht.get_data.apply(Ht,arguments)})},[Object(n["g"])("a",{class:"dropdown-item phraseSelect","data-song":t,"data-segment":i}," Segment "+Object(n["m"])(i)+" "+Object(n["m"])($t.songData[t][i]),9,["data-song","data-segment"])])])):Object(n["d"])("",!0)])})),128))])])})),128))])])]),Object(n["g"])("ul",u,[Object(n["g"])("li",p,[Object(n["g"])("button",g,"Phrase ID: "+Object(n["m"])(this.songID.slice(0,3))+": "+Object(n["m"])(this.songname)+" "+Object(n["m"])(this.songID.slice(4))+" | "+Object(n["m"])(this.songkey),1),f]),b])])]),Object(n["g"])("div",m,[Object(n["g"])("table",v,[Object(n["g"])("thead",y,[Object(n["g"])("tr",null,[O,Object(n["g"])("div",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("th",{class:"time_cell",key:t,id:"time"+(t-1)},Object(n["m"])((t+3-(t-1)%4)/4+"."+((t-1)%4+1)),9,["id"])})),64)),j,k])])])]),Object(n["g"])(Kt,{type:"piano-roll",class:"right",id:"original_vis",noteSequence:this.original_noteseq,config:this.cfg},null,8,["noteSequence","config"]),Object(n["g"])("div",x,[Object(n["g"])(Kt,{type:"piano-roll",class:"right",id:"original_vis_overlay",noteSequence:this.original_noteseq_overlay,config:this.cfg_mel},null,8,["noteSequence","config"]),w,Object(n["g"])("div",q,[Object(n["g"])("table",T,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[Object(n["g"])("th",{id:"play_prog_original",class:"prog_head",onClick:e[3]||(e[3]=function(){return Ht.play_prog_original&&Ht.play_prog_original.apply(Ht,arguments)})},"Original"),Object(n["g"])("div",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(e){return Object(n["g"])("td",{key:e,id:"original_prog"+(e-1),class:"table_cell",style:{"font-weight":"normal"},onClick:function(t){return Ht.play_chord("original",e-1)}},Object(n["m"])(t.original_chd_str[e-1]),9,["id","onClick"])})),64)),I,E])])])]),Object(n["g"])("table",S,[Object(n["g"])("thead",D,[Object(n["g"])("tr",null,[Object(n["g"])("div",null,[Object(n["g"])("th",{class:"prog_head table_cell",onClick:e[4]||(e[4]=function(){return Ht.replay_all&&Ht.replay_all.apply(Ht,arguments)})}),(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("th",{class:"time_cell",key:t,id:"time_altered"+(t-1),onClick:function(e){return Ht.replay_bar(t-1)}},Object(n["m"])((t+3-(t-1)%4)/4+"."+((t-1)%4+1)),9,["id","onClick"])})),64)),Object(n["g"])("th",{class:"time_cell",onClick:e[5]||(e[5]=function(){return Ht.replay_all&&Ht.replay_all.apply(Ht,arguments)})},"Replay"),Object(n["g"])("th",{class:"time_cell",onClick:e[6]||(e[6]=function(){return Ht.replay_all&&Ht.replay_all.apply(Ht,arguments)})})])])])]),M,C,Object(n["g"])("div",P,[Object(n["g"])("table",A,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[Object(n["g"])("div",null,[Object(n["g"])("th",{id:"play_prog_original",class:"prog_head",onClick:e[7]||(e[7]=function(){return Ht.play_prog_altered&&Ht.play_prog_altered.apply(Ht,arguments)})},"Altered"),(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(e){return Object(n["g"])("td",{key:e,id:"altered"+(e-1),class:"table_cell",style:{"font-weight":"normal"},onClick:function(t){return Ht.play_chord("altered",e-1)}},[t.hide_vis_input?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("span",B,Object(n["m"])(t.altered_chd_str[e-1]),1))],8,["id","onClick"])})),64)),Object(n["g"])("th",null,[this.playing?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("span",{key:0,class:"table_tail",onClick:e[8]||(e[8]=function(){return Ht.test_add&&Ht.test_add.apply(Ht,arguments)})},"Add to test"))])])])])]),Object(n["g"])("div",L,[Object(n["g"])("div",R,[Object(n["g"])("button",{id:"altered_reset",class:"btn btn-light",onClick:e[9]||(e[9]=function(){return Ht.player_reset&&Ht.player_reset.apply(Ht,arguments)})},"Reset"),F,H,Object(n["g"])("span",$,Object(n["m"])(this.bpm),1),Object(n["g"])("div",K,[Object(n["o"])(Object(n["g"])("input",{type:"range",class:"form-control-range",id:"bpm_slider",min:"30",max:"200","onUpdate:modelValue":e[10]||(e[10]=function(e){return t.bpm=e})},null,512),[[n["n"],t.bpm]])]),Object(n["g"])("div",N,[Object(n["g"])("div",U,[Object(n["g"])("input",{type:"checkbox",id:"root_overlay",checked:t.root_overlay,onClick:e[11]||(e[11]=function(t){return $t.root_on_click()})},null,8,["checked"]),X,Y])]),Object(n["g"])("div",z,[Object(n["g"])("div",Z,[Object(n["g"])("input",{type:"checkbox",id:"chord_overlay",checked:t.chord_overlay,onClick:e[12]||(e[12]=function(t){return $t.chord_on_click()})},null,8,["checked"]),J,G])]),V,Object(n["g"])("div",null,[Object(n["g"])("button",{class:"btn btn-light",onClick:e[13]||(e[13]=function(){return Ht.test_clear&&Ht.test_clear.apply(Ht,arguments)}),disabled:this.test_chd_strs.length<1||t.playing},"Clear Test",8,["disabled"]),Q,W,Object(n["g"])("button",{class:"btn btn-light",onClick:e[14]||(e[14]=function(){return Ht.test_apply&&Ht.test_apply.apply(Ht,arguments)}),disabled:this.test_chd_strs.length<1||t.playing},"Test",8,["disabled"]),tt,Object(n["g"])("button",{class:"btn btn-light",onClick:e[15]||(e[15]=function(){return Ht.test_show_answer&&Ht.test_show_answer.apply(Ht,arguments)}),disabled:!t.hide_vis_input||t.playing},"Show answer",8,["disabled"]),et]),(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(this.test_chd_strs.length,(function(e){return Object(n["h"])(),Object(n["c"])("div",{key:e},[e!=$t.test_idx+1||t.hide_vis_input?(Object(n["h"])(),Object(n["c"])("div",rt,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(4,(function(t){return Object(n["g"])("span",{key:t},[Object(n["f"])(Object(n["m"])($t.test_chd_strs[e-1][4*(t-1)])+" ",1),t<4?(Object(n["h"])(),Object(n["c"])("span",ct,"  - ")):Object(n["d"])("",!0)])})),64))])):(Object(n["h"])(),Object(n["c"])("div",it,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(4,(function(t){return Object(n["g"])("span",{key:t},[Object(n["f"])(Object(n["m"])($t.test_chd_strs[e-1][4*(t-1)])+" ",1),t<4?(Object(n["h"])(),Object(n["c"])("span",nt,"  - ")):Object(n["d"])("",!0)])})),64))]))])})),128)),st,Object(n["g"])("button",{class:"btn btn-light",onClick:e[16]||(e[16]=function(){return Ht.connect_midi&&Ht.connect_midi.apply(Ht,arguments)})},"Connect MIDI output device (Chrome only)"),Object(n["g"])("div",at,[Object(n["g"])("button",lt," Channel "+Object(n["m"])(this.midi_channel),1),Object(n["g"])("div",ot,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(16,(function(t){return Object(n["g"])("div",{key:t},[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:function(e){return Ht.change_midi_channel(t)}},"Channel "+Object(n["m"])(t),9,["onClick"])])})),64))])]),ht,this.show_midi_devices?(Object(n["h"])(),Object(n["c"])("p",dt,Object(n["m"])(this.midi_device_names),1)):Object(n["d"])("",!0),_t,this.phrasebank_loaded?Object(n["d"])("",!0):(Object(n["h"])(),Object(n["c"])("p",ut,"Loading phrase bank... This could take around a minute."))]),Object(n["g"])("div",pt,[Object(n["g"])("div",gt,[Object(n["g"])("button",ft,[Object(n["f"])(Object(n["m"])("Input type: "+this.input_type)+" ",1),bt]),Object(n["g"])("ul",mt,[Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[17]||(e[17]=function(t){return Ht.change_input_type("movable")})},"Movable")]),Object(n["g"])("li",null,[Object(n["g"])("a",{class:"dropdown-item",href:"#",onClick:e[18]||(e[18]=function(t){return Ht.change_input_type("fixed")})},"Fixed")])]),"movable"==this.input_type?(Object(n["h"])(),Object(n["c"])("div",vt,[Object(n["g"])("button",yt,[Object(n["f"])(Object(n["m"])("Key: "+this.key+" major")+" ",1),Ot]),Object(n["g"])("ul",jt,[Object(n["g"])("li",null,[(Object(n["h"])(!0),Object(n["c"])(n["a"],null,Object(n["k"])(this.scales_major,(function(t){return Object(n["h"])(),Object(n["c"])("a",{key:t,class:"dropdown-item",href:"#",onClick:function(e){return Ht.change_key(t)}},Object(n["m"])(t+" major"),9,["onClick"])})),128))])])])):Object(n["d"])("",!0)]),this.loaded&&!this.hide_vis_input?(Object(n["h"])(),Object(n["c"])("div",kt,["fixed"==t.input_type?(Object(n["h"])(),Object(n["c"])(Nt,{key:0,onUpdate_current_chord:Ht.update_current_chord},null,8,["onUpdate_current_chord"])):Object(n["d"])("",!0),"movable"==t.input_type?(Object(n["h"])(),Object(n["c"])(Ut,{key:1,ref:"dial",interface_key:this.key,roots:t.scales_major,onUpdate_current_chord:Ht.update_current_chord},null,8,["interface_key","roots","onUpdate_current_chord"])):Object(n["d"])("",!0)])):Object(n["d"])("",!0)]),Object(n["g"])("div",xt,[wt,Object(n["g"])(Xt,{onSet_filter:Ht.set_filter},null,8,["onSet_filter"]),Object(n["g"])(Yt,{ref:"phrase_selector",noteseqs:this.next_phrases,onUpdate_next_phrase:Ht.update_next_phrase},null,8,["noteseqs","onUpdate_next_phrase"])])])])])])]),qt,Tt,It,Object(n["g"])(zt,{noteSequence:this.original_noteseq,"sound-font":"",visualizer:"#original_vis",id:"original_player"},null,8,["noteSequence"]),Object(n["g"])("div",Et,[Object(n["g"])("div",St,[Object(n["g"])("div",Dt,[Object(n["g"])("input",{type:"checkbox",id:"root_overlay",checked:t.mel,onClick:e[19]||(e[19]=function(t){return $t.mel_on_click()})},null,8,["checked"]),Mt,Ct])]),Object(n["g"])("div",Pt,[Object(n["g"])("div",At,[Object(n["g"])("input",{type:"checkbox",id:"chord_overlay",checked:t.acc,onClick:e[20]||(e[20]=function(t){return $t.acc_on_click()})},null,8,["checked"]),Bt,Lt])])])])}var Ft=i("b85c"),Ht=(i("cb29"),i("b0c0"),i("a15b"),i("99af"),i("ac1f"),i("5319"),i("159b"),i("caad"),Object(n["q"])("data-v-0c3b6279"));Object(n["j"])("data-v-0c3b6279");var $t=Object(n["g"])("p",null,"Current chord:",-1),Kt={id:"root_table",class:"table table-bordered table-fixed"};Object(n["i"])();var Nt=Ht((function(t,e,i,r,c,s){return Object(n["h"])(),Object(n["c"])("div",null,[$t,Object(n["g"])("p",{id:"current_chord_text",class:{text_major:"M"==t.current_chord_type,text_minor:"m"==t.current_chord_type,text_dom:"D"==t.current_chord_type}},Object(n["m"])(s.current_chord_text),3),Object(n["g"])("table",Kt,[Object(n["g"])("tbody",null,[Object(n["g"])("tr",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(12,(function(e){return Object(n["g"])("td",{key:e,id:"root_"+e,onClick:function(t){return s.root_on_click(e-1,t)},onContextmenu:Object(n["p"])((function(t){return s.root_on_rightclick(e-1,t)}),["prevent"]),onMouseup:Object(n["p"])((function(t){return s.root_on_middleclick(e-1,t)}),["middle"]),class:{root_cell:!0,root_black:[1,3,6,8,10].includes(e-1),major:"M"==t.current_chord_type&&t.current_chord_root==e-1,minor:"m"==t.current_chord_type&&t.current_chord_root==e-1,dom:"D"==t.current_chord_type&&t.current_chord_root==e-1}},Object(n["m"])(t.roots[e-1]),43,["id","onClick","onContextmenu","onMouseup"])})),64))])])])])})),Ut={name:"InterfaceFixed",data:function(){return{roots:["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3}},computed:{current_chord_text:function(){return 3==this.current_chord_interval?"M"==this.current_chord_type?this.roots[this.current_chord_root]:this.roots[this.current_chord_root]+this.current_chord_type:"D"==this.current_chord_type?this.roots[this.current_chord_root]+this.current_chord_interval:"M"==this.current_chord_type?this.roots[this.current_chord_root]+"maj"+this.current_chord_interval:this.roots[this.current_chord_root]+this.current_chord_type+this.current_chord_interval}},methods:{root_on_click:function(t,e){e.ctrlKey?this.root_on_rightclick(t,e):(this.current_chord_root=t,this.current_chord_type="M",e.altKey?this.current_chord_interval=7:e.shiftKey&&void 0!=e.movementX?(this.current_chord_type="D",this.current_chord_interval=7):this.current_chord_interval=3,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text))},root_on_rightclick:function(t,e){this.current_chord_root=t,this.current_chord_type="m",this.current_chord_interval=3,e.altKey?this.current_chord_interval=7:this.current_chord_interval=3,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text)},root_on_middleclick:function(t){this.current_chord_root=t,this.current_chord_type="D",this.current_chord_interval=7,this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.current_chord_text)},keyboard_functions:function(t){var e=t.key;if(["!","@","#","$","%","^","&","*","(",")","_","+"].includes(e)){t.preventDefault();var i=["!","@","#","$","%","^","&","*","(",")","_","+"].indexOf(e);this.root_on_click(i,t)}else if(["⁄","€","‹","›","ﬁ","ﬂ","‡","°","·","—","±"].includes(e)){t.preventDefault();var n=["⁄","€","‹","›","ﬁ","ﬂ","‡","°","·","—","±"].indexOf(e);this.root_on_click(n,t)}else if(["1","2","3","4","5","6","7","8","9","0","-","="].includes(e)&&t.ctrlKey){t.preventDefault();var r=["1","2","3","4","5","6","7","8","9","0","-","="].indexOf(e);this.root_on_rightclick(r,t)}else if(["1","2","3","4","5","6","7","8","9","0","-","="].includes(e)&&t.altKey){t.preventDefault();var c=["1","2","3","4","5","6","7","8","9","0","-","="].indexOf(e);this.root_on_middleclick(c,t)}else if(["¡","™","£","¢","∞","§","¶","•","ª","º","–","≠"].includes(e)){t.preventDefault();var s=["¡","™","£","¢","∞","§","¶","•","ª","º","–","≠"].indexOf(e);this.root_on_middleclick(s,t)}}},mounted:function(){document.addEventListener("keydown",this.keyboard_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keyboard_functions)}};i("dc1a");Ut.render=Nt,Ut.__scopeId="data-v-0c3b6279";var Xt=Ut,Yt=Object(n["g"])("svg",{id:"dial_svg"},null,-1);function zt(t,e,i,r,c,s){return Object(n["h"])(),Object(n["c"])("div",null,[Yt])}var Zt=i("5698"),Jt=i("772f"),Gt=Jt.Note,Vt=Jt.Scale;console.log(Gt,Vt);var Qt={name:"InterfaceMovable",props:{interface_key:String,roots:Array},data:function(){return{major_scale:[0,2,4,5,7,9,11],current_chord_root:"0",current_chord_type:"M",current_chord_interval:3,dial_r_outer:100,degree_text:["I","ii","iii","IV","V","vi","vii°"],alt:!1,ctrl:!1,shift:!1,s:!1}},computed:{interface_key_idx:function(){return this.roots.indexOf(this.interface_key)},dial_r_center:function(){return this.dial_r_outer/2},dial_r_degrees:function(){return 1.5*this.dial_r_outer},scale_roots:function(){return Vt.get(this.interface_key+" major").notes}},methods:{outer_text:function(t){for(var e=Vt.get(t+" major").notes,i=0;i<3;i++)e[[1,2,5][i]]+="m";return e[6]+="dim",e},draw_dial:function(t){var e=this;Zt.selectAll("g").remove().exit();for(var i=Zt.select("#dial_svg").append("g").attr("class","g").attr("transform","translate("+(this.dial_r_degrees+5)+","+(this.dial_r_degrees+5)+")"),n=this,r=function(r){var c=Zt.arc().innerRadius(e.dial_r_center).outerRadius(e.dial_r_outer).startAngle(2*r*Math.PI/t.length).endAngle(2*(r+1)*Math.PI/t.length);i.append("path").attr("d",c).attr("id","outer_path"+r).attr("class","outer_path").on("click",(function(){n.outer_on_click(r)})).on("contextmenu",(function(t){t.preventDefault(),n.outer_on_click(r)})).on("mouseover",(function(){Zt.select("#outer_path"+r).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Zt.select("#outer_path"+r).classed("outer_path_mouseover",!1)})),i.append("text").attr("dx",(e.dial_r_outer+e.dial_r_center)/2*Math.cos(2*r*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("dy",(e.dial_r_outer+e.dial_r_center)/2*Math.sin(2*r*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("class","outer_text").attr("id","outer_text"+r).text(t[r]).on("click",(function(){n.outer_on_click(r)})).on("contextmenu",(function(t){t.preventDefault(),n.outer_on_click(r)})).on("mouseover",(function(){Zt.select("#outer_path"+r).classed("outer_path_mouseover",!0)})).on("mouseout",(function(){Zt.select("#outer_path"+r).classed("outer_path_mouseover",!1)})),i.append("text").attr("dx",(e.dial_r_outer+e.dial_r_degrees)/2*Math.cos(2*r*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("dy",(e.dial_r_outer+e.dial_r_degrees)/2*Math.sin(2*r*Math.PI/t.length+(1/7-.5)*Math.PI)).attr("class","outer_text").text(e.degree_text[r])},c=0;c<t.length;c++)r(c);i.append("circle").attr("x",0).attr("y",0).attr("r",this.dial_r_center).attr("class","center_path"),i.append("text").attr("class","center_text").attr("id","center_text").text("")},get_current_chord_text:function(t){return 3==this.current_chord_interval?"M"==this.current_chord_type?t:t+this.current_chord_type:"D"==this.current_chord_type?t+this.current_chord_interval:"M"==this.current_chord_type?t+"maj"+this.current_chord_interval:t+this.current_chord_type+this.current_chord_interval},update_center_text:function(t){var e=Zt.select("#center_text");e.text(t),e.classed("text_major",!1),e.classed("text_minor",!1),e.classed("text_dom",!1),"M"==this.current_chord_type&&Zt.select("#center_text").classed("text_major",!0),"m"==this.current_chord_type&&e.classed("text_minor",!0),"D"==this.current_chord_type&&e.classed("text_dom",!0)},outer_on_click:function(t){this.current_chord_root=(this.major_scale[t]+this.roots.indexOf(this.interface_key))%12;var e=this.scale_roots[t];this.s&&(this.current_chord_root=(this.current_chord_root+7)%12,e=this.scale_roots[(t+4)%7],6==t&&(2==e.length&&"b"==e.charAt(1)?e=e.charAt(0):e+="#"),this.current_chord_interval=7,this.current_chord_type="D"),this.alt?(this.current_chord_interval=7,this.current_chord_type="D",this.shift?this.current_chord_type="M":this.ctrl&&(console.log("CTRL"),this.current_chord_type="m")):this.shift?(this.current_chord_interval=3,this.current_chord_type="M"):this.ctrl?(this.current_chord_interval=3,this.current_chord_type="m"):this.s||(this.current_chord_interval=3,[0,3,4].includes(t)?this.current_chord_type="M":this.current_chord_type="m"),this.update_center_text(this.get_current_chord_text(e)),this.$emit("update_current_chord",this.current_chord_root+this.current_chord_type+this.current_chord_interval,this.get_current_chord_text(e));for(var i=0;i<7;i++)Zt.select("#outer_path"+i).classed("outer_path_active",!1);Zt.select("#outer_path"+t).classed("outer_path_active",!0)},keydown_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!0),"Shift"==e&&(t.preventDefault(),this.shift=!0),"Control"==e&&(t.preventDefault(),this.ctrl=!0),["S","s"].includes(e)&&(t.preventDefault(),this.s=!0),["1","2","3","4","5","6","7"].includes(e)&&(t.preventDefault(),this.outer_on_click(["1","2","3","4","5","6","7"].indexOf(e))),["!","@","#","$","%","^","&"].includes(e)&&(t.preventDefault(),this.outer_on_click(["!","@","#","$","%","^","&"].indexOf(e))),["¡","™","£","¢","∞","§","¶"].includes(e)&&(t.preventDefault(),this.outer_on_click(["¡","™","£","¢","∞","§","¶"].indexOf(e))),["⁄","€","‹","›","ﬁ","ﬂ","‡"].includes(e)&&(t.preventDefault(),this.outer_on_click(["⁄","€","‹","›","ﬁ","ﬂ","‡"].indexOf(e)))},keyup_functions:function(t){var e=t.key;"Alt"==e&&(t.preventDefault(),this.alt=!1),"Shift"==e&&(t.preventDefault(),this.shift=!1),"Control"==e&&(t.preventDefault(),this.ctrl=!1),["S","s"].includes(e)&&(t.preventDefault(),this.s=!1)}},mounted:function(){this.draw_dial(this.outer_text(this.interface_key)),document.addEventListener("keydown",this.keydown_functions),document.addEventListener("keyup",this.keyup_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keydown_functions),document.removeEventListener("keyup",this.keyup_functions)}};i("9c32");Qt.render=zt;var Wt=Qt,te=Object(n["q"])("data-v-ac833fb6");Object(n["j"])("data-v-ac833fb6");var ee=Object(n["e"])('<svg id="filter_svg" height="200px" width="200px" data-v-ac833fb6></svg><img src="accFilter_icons/vSparse.svg" height="200" width="200" class="filter_icon" id="vSparse" data-v-ac833fb6><img src="accFilter_icons/vDense.svg" height="200" width="200" class="filter_icon" id="vDense" data-v-ac833fb6><img src="accFilter_icons/hSparse.svg" height="200" width="200" class="filter_icon" id="hSparse" data-v-ac833fb6><img src="accFilter_icons/hDense.svg" height="200" width="200" class="filter_icon" id="hDense" data-v-ac833fb6>',5),ie=Object(n["g"])("br",null,null,-1);Object(n["i"])();var ne=te((function(t,e,i,r,c,s){return Object(n["h"])(),Object(n["c"])(n["a"],null,[ee,Object(n["g"])("button",{class:"btn btn-light up",onClick:e[1]||(e[1]=function(){return s.reset&&s.reset.apply(s,arguments)})},"Reset"),ie],64)})),re=i("5698"),ce={name:"PhraseFilter",data:function(){return{x:-1,y:201,filter_h:-1,filter_v:-1}},computed:{},methods:{reset:function(){this.x=-1,this.y=201,re.selectAll(".circle").remove().exit(),this.set_filter()},set_filter:function(){var t=(this.x-this.x%40)/40,e=4-(this.y-this.y%40)/40;this.x<0&&(t=-1),t==this.filter_h&&e==this.filter_v||(this.filter_h=t,this.filter_v=e,this.$emit("set_filter",[this.filter_h,this.filter_v]))}},mounted:function(){var t=200,e=5,i=2,n=this,r=re.drag().on("drag",(function(t){var e=document.getElementById("filter_svg").getBoundingClientRect(),i=(t.sourceEvent.clientX-e.x)/.6,r=(t.sourceEvent.clientY-e.y)/.6;i>200&&(i=199),i<0&&(i=1),r>200&&(r=199),r<0&&(r=1),n.x=i,n.y=r,re.selectAll(".circle").attr("cx",i).attr("cy",r),n.set_filter()})),c=re.select("#filter_svg");c.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",t).attr("fill","black").attr("opacity",.3),c.append("rect").attr("x",0).attr("y",0).attr("width",t).attr("height",t).attr("fill","black").attr("opacity",0).classed("background",!0).on("mousedown",(function(t){var e=document.getElementById("filter_svg").getBoundingClientRect();re.selectAll(".circle").remove().exit(),c.append("circle").attr("cx",(t.clientX-e.x)/.6).attr("cy",(t.clientY-e.y)/.6).attr("r",10).attr("fill","#00a2ff").classed("circle",!0),r(c.selectAll(".circle")),n.x=(t.clientX-e.x)/.6,n.y=(t.clientY-e.y)/.6,n.set_filter()})),r(c.selectAll(".background"));for(var s=1;s<e;s++)c.append("rect").attr("x",s*t/e).attr("y",0).attr("width",i).attr("height",t).attr("fill","white").attr("opacity",.3),c.append("rect").attr("x",0).attr("y",s*t/e).attr("width",t).attr("height",i).attr("fill","white").attr("opacity",.3);re.selectAll(".background").raise()},beforeUnmount:function(){}};i("306f");ce.render=ne,ce.__scopeId="data-v-ac833fb6";var se=ce,ae=Object(n["q"])("data-v-fa5e1bb8");Object(n["j"])("data-v-fa5e1bb8");var le={class:"up"},oe={id:"phrase_table",class:"table table-bordered table-fixed"};Object(n["i"])();var he=ae((function(t,e,i,r,c,s){var a=Object(n["l"])("midi-visualizer");return Object(n["h"])(),Object(n["c"])("div",le,[Object(n["g"])("table",oe,[Object(n["g"])("tbody",null,[(Object(n["h"])(),Object(n["c"])(n["a"],null,Object(n["k"])(3,(function(e){return Object(n["g"])("tr",{key:e,id:"phrase_"+e,onClick:function(t){return s.phrase_on_click(e-1)},class:{phrase_cell:!0,selected:e-1==t.next_phrase_idx}},[Object(n["g"])("td",null,[Object(n["g"])(a,{type:"piano-roll",id:"vis[i-1]",noteSequence:i.noteseqs[e-1],config:t.cfg},null,8,["noteSequence","config"])])],10,["id","onClick"])})),64))])])])})),de={name:"PhraseSelect",props:{noteseqs:Array},data:function(){return{next_phrase_idx:-1,cfg:{noteHeight:2,pixelsPerTimeStep:40,minPitch:35,maxPitch:80,noteSpacing:.5}}},computed:{},methods:{reset:function(){this.next_phrase_idx=-1},phrase_on_click:function(t){this.next_phrase_idx=t,this.$emit("update_next_phrase",t)},keyboard_functions:function(t){var e=t.key;return e}},mounted:function(){document.addEventListener("keydown",this.keyboard_functions)},beforeUnmount:function(){document.removeEventListener("keydown",this.keyboard_functions)}};i("bd23");de.render=he,de.__scopeId="data-v-fa5e1bb8";var _e=de,ue=i("bc3a").default,pe=i("5698"),ge=i("8350"),fe=i("7360"),be=i("cdc9"),me=be.WebMidi;console.log(fe);var ve=new ge.SoundFontPlayer("https://storage.googleapis.com/magentadata/js/soundfonts/sgm_plus"),ye={name:"App",components:{InterfaceFixed:Xt,InterfaceMovable:Wt,PhraseFilter:se,PhraseSelect:_e},data:function(){return{BACKEND_PATH:"",STEP_SIZE:4,scales_major:["C","Db","D","Eb","E","F","F#","G","Ab","A","Bb","B"],prog_step_duration:.5,octave_center:48,allData:{},songID:"000",songname:"",songkey:"",songData:{},original_noteseq:0,original_noteseq_mixed:0,original_noteseq_mel:0,original_noteseq_acc:0,original_noteseq_overlay:{notes:[{pitch:30,start:0,end:16}],totalTime:16},empty_noteseq:{notes:[{pitch:30,start:0,end:16}],totalTime:16},original_chd_str:0,original_chd_mat:0,notedic:0,notedic_mixed:0,notedic_mel:0,notedic_acc:0,sustain:[],altered_noteseq:{notes:[],totalTime:16},altered_noteseqs:[0,0,0,0],altered_chd_str:Array(16).fill(""),altered_chd_mat:Array(16).fill(Array(36).fill(0)),chds:[],test_chd_strs:[],test_chds:[],altered_chd_str_hide:[],test_idx:-1,bpm:60,playing:!1,loaded:!1,phrasebank_loaded:!1,hide_vis_input:!1,input_type:"fixed",key:"C",mel:!1,acc:!0,t:0,chord_seq:[],current_chd:"",current_chd_text:"",altered_vis:0,cfg:{noteHeight:4,pixelsPerTimeStep:100,minPitch:20,maxPitch:90,noteSpacing:1},cfg_mel:{noteHeight:4,pixelsPerTimeStep:100,minPitch:20,maxPitch:90,noteSpacing:1,noteRGB:"255,0,0"},root_overlay:!0,chord_overlay:!1,next_phrases_id:[0,0,0],next_phrases:[0,0,0],next_phrase_idx:-1,edge_weights:[],filter_h:-1,filter_v:-1,show_midi_devices:!1,midi_device_names:[],midi_device:0,midi_channel:1}},computed:{},methods:{list_to_noteseq:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,n=[],r=0;r<t.length;r++){var c=t[r][0],s=t[r][1],a=t[r][2],l=t[r][3];e>=8&&(c+=8,s+=8),c>=e&&c<i&&n.push({pitch:a,startTime:c,endTime:s,velocity:l})}return n},chords_to_noteseq:function(t){for(var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=[],n=0;n<t.length;n++){for(var r=t[n],c=[],s=0;s<12;s++)1==r[12+s]&&c.push(s);if(-1==r.slice(0,13).indexOf(1))break;e?i.push([r.slice(0,13).indexOf(1),c,0]):i.push([r.slice(0,13).indexOf(1),c,r.slice(24,36).indexOf(1)])}t=i;var a=[];if(t.length>0){for(var l=t[0],o=this.prog_step_duration,h=1;h<t.length;h++)if(JSON.stringify(t[h])==JSON.stringify(l))o+=this.prog_step_duration;else{for(var d=parseInt(l[0]),_=l[1],u=parseInt(l[2]),p=0;p<_.length;p++)e?a.push({pitch:parseInt(_[p])+d+this.octave_center,startTime:this.prog_step_duration*h-o,endTime:this.prog_step_duration*h}):a.push({pitch:parseInt(_[p])+this.octave_center,startTime:this.prog_step_duration*h-o,endTime:this.prog_step_duration*h});a.push({pitch:u+d+this.octave_center-12,startTime:this.prog_step_duration*h-o,endTime:this.prog_step_duration*h}),l=t[h],o=this.prog_step_duration}for(var g=parseInt(l[0]),f=l[1],b=parseInt(l[2]),m=0;m<f.length;m++)e?a.push({pitch:parseInt(f[m])+g+this.octave_center,startTime:this.prog_step_duration*t.length-o,endTime:this.prog_step_duration*t.length}):a.push({pitch:parseInt(f[m])+this.octave_center,startTime:this.prog_step_duration*t.length-o,endTime:this.prog_step_duration*t.length});return a.push({pitch:b+g+this.octave_center-12,startTime:this.prog_step_duration*t.length-o,endTime:this.prog_step_duration*t.length}),{notes:a,totalTime:this.prog_step_duration*t.length}}},get_songdata:function(){var t=this;ue.get(this.BACKEND_PATH+"/get_songdata").then((function(e){var i=e.data;i.songData||(i=JSON.parse(e.data)),t.songData=i.songData}))},get_data:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"000",i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("string"!=typeof e&&(e=void 0!=e.target.dataset.song?e.target.dataset.song.slice(0,3)+"_"+e.target.dataset.segment:"000"),"000"==e){var n=Object.keys(this.allData).slice(1);e=n[Math.floor(Math.random()*n.length)]}var r=this.allData[e];this.songID=r.songID,this.original_noteseq_mixed=r.original_noteseq_mixed,this.original_noteseq_mel=r.original_noteseq_mel,this.original_noteseq_acc=r.original_noteseq_acc,this.original_chd_str=r.original_chd_str,this.original_chd_mat=r.original_chd_mat,this.notedic_mixed=r.notedic_mixed,this.notedic_mel=r.notedic_mel,this.notedic_acc=r.notedic_acc,this.sustain=r.sustain,this.songname=r.name,this.songkey=r.key,this.update_melacc_toggle();for(var c=1;c<4;c++)for(var s=0;s<this.sustain.length;s++){var a=this.sustain[s][0],l=this.sustain[s][1];if(a<4*c&&l>4*c)break;if(a>4*c){s>0?this.sustain[s-1][1]=4*c+1:this.sustain.push([4*c-1,4*c+1]);break}}this.altered_vis=new ge.PianoRollCanvasVisualizer({notes:[{pitch:30,start:0,end:8}],totalTime:16},document.getElementById("altered_canvas"),this.cfg),this.update_overlay(),this.test_show_answer(),i&&this.player_reset(),this.place_barlines_and_player(),setTimeout((function(){t.place_barlines_and_player()}),1e3),setTimeout((function(){t.place_barlines_and_player()}),3e3),this.update_next_phrases()},get_data_all:function(){var t=this;ue.get(this.BACKEND_PATH+"/get_data_all").then((function(e){var i=e.data;i.songID||(i=JSON.parse(e.data)),t.allData=i,t.edge_weights=i["edge_weights"],t.get_data(),t.phrasebank_loaded=!0,t.apply_filter_anchors()}))},player_play:function(){if(this.loaded&&this.playing){if(this.t%this.STEP_SIZE==0&&(0==this.t&&-1!=this.next_phrase_idx&&(this.get_data(this.next_phrases_id[this.next_phrase_idx],!1),this.next_phrase_idx=-1,this.update_next_phrases(),this.$refs.phrase_selector.reset()),this.player_query_step()),!this.playing)return;this.t+=4,16==this.t&&(this.t=0)}},player_reset:function(){this.playing=!1,this.loaded=!0,this.t=0,this.altered_noteseq.notes=[],this.altered_noteseqs=[0,0,0,0],this.chord_seq=[],this.altered_chd_str=Array(16).fill(""),this.altered_chd_mat=Array(16).fill(Array(36).fill(0)),this.altered_vis.redraw(),this.update_overlay()},player_query_step:function(){var t=this;if(""!=this.current_chd){setTimeout((function(){t.player_play()}),24e4/this.bpm);for(var e=this.t;e<this.t+4;e++)this.highlight_cell("altered"+e,24e4/this.bpm/1e3);var i=function e(i){t.highlight_cell("time_altered"+i,6e4/t.bpm/1e3),i%4!=3&&setTimeout((function(){e(i+1)}),6e4/t.bpm)};i(this.t),0==this.t&&(this.altered_chd_str=Array(16).fill(""),this.altered_chd_mat=Array(16).fill(Array(36).fill(0)),this.altered_noteseq.notes=[],this.altered_noteseqs=[0,0,0,0],this.chds=[]),this.t%this.STEP_SIZE==0&&(this.chord_seq=[]),this.chds.push(this.current_chd),this.chord_seq.push(this.current_chd);var n=parseInt(this.current_chd.slice(0,-2)),r=this.current_chd.slice(-2);this.current_chd="",this.altered_chd_str[this.t]=this.current_chd_text,this.current_chd_text="";for(var c=8/this.STEP_SIZE,s=[],a=0;a<this.chord_seq.length;a++)s.push(this.chord_seq[a]);while(s.length<c)s.push(s[s.length-1]);s=s.join(",");var l=this.notedic[(this.t-this.t%8)/8][s],o=this.list_to_noteseq(l,this.t,this.t+this.STEP_SIZE,!0);this.altered_noteseq.notes=this.altered_noteseq.notes.concat(o);var h=this.notes_to_quant_noteseq(o);ve.isPlaying()&&ve.stop(),ve.start(h,this.bpm),this.altered_noteseqs[(this.t-this.t%4)/4]=h,this.hide_vis_input||(this.altered_vis.noteSequence=this.altered_noteseq,this.altered_vis.redraw());var d=Array(36).fill(0);d[n]=1,d[24]=1;var _=[0,4,7],u=[0,3,7],p=[0,4,7,11],g=[0,3,7,10],f=[0,4,7,10],b=0;"M3"==r&&(b=_),"m3"==r&&(b=u),"M7"==r&&(b=p),"m7"==r&&(b=g),"D7"==r&&(b=f);for(var m=0;m<b.length;m++)d[(n+b[m])%12+12]=1;for(var v=this.t;v<this.t+this.STEP_SIZE;v++)this.altered_chd_mat[v]=d;this.update_overlay()}else this.playing=!1},notes_to_quant_noteseq:function(t){for(var e={notes:[],quantizationInfo:{stepsPerQuarter:4},tempos:[{time:0,qpm:60}],totalQuantizedSteps:64},i=0;i<t.length;i++){for(var n=t[i],r=n.startTime,c=n.endTime,s=0;s<this.sustain.length;s++){var a=this.sustain[s][0],l=this.sustain[s][1];if(n.endTime>a&&n.endTime<l){c=l;break}if(n.endTime<a)break}e.notes.push({pitch:n.pitch,quantizedStartStep:4*(r-this.t),quantizedEndStep:Math.round(4*(c-this.t)),veloicity:n.velocity})}return e},canvas_update_note:function(t){var e=this.t;0==e&&(e=16);var i={pitch:t.pitch,startTime:t.startTime*this.bpm/60+e-4,endTime:t.endTime*this.bpm/60+e-4};this.altered_vis.redraw(i)},change_input_type:function(t){this.input_type=t},change_key:function(t){this.key=t,this.$refs.dial.draw_dial(this.$refs.dial.outer_text(t))},update_current_chord:function(t,e){if(this.current_chd=t,this.current_chd_text=e,this.playing){var i=parseInt(this.current_chd.slice(0,-2)),n=this.current_chd.slice(-2),r=Array(36).fill(0),c=this.t;r[i]=1,r[i+24]=1;var s=[0,4,7],a=[0,3,7],l=[0,4,7,11],o=[0,3,7,10],h=[0,4,7,10],d=0;"M3"==n&&(d=s),"m3"==n&&(d=a),"M7"==n&&(d=l),"m7"==n&&(d=o),"D7"==n&&(d=h);for(var _=0;_<d.length;_++)r[(i+d[_])%12+12]=1;for(var u=c;u<c+this.STEP_SIZE;u++)this.altered_chd_mat[u]=r;this.update_overlay(),this.altered_chd_str[c]=this.current_chd_text}else this.playing=!0,this.player_play()},draw_overlay_bar:function(t,e,i,n){e*=100;while(i<=90)i>=30&&t.append("rect").attr("fill",n).attr("opacity",.3).attr("x",e).attr("y",this.cfg.noteHeight*(this.cfg.maxPitch-i)).attr("width",100).attr("height",4).attr("class","overlay"),i+=12},clear_overlay:function(){pe.selectAll(".overlay").remove().exit()},get_color:function(t){return pe.interpolateSinebow((t/12+.6)%1)},draw_root_overlay:function(){for(var t=0;t<this.original_chd_mat.length;t++){var e=this.original_chd_mat[t],i=e.slice(0,12).indexOf(1);this.draw_overlay_bar(pe.select(".original_svg"),t,i,this.get_color(0)),this.altered_chd_mat[t].slice(0,12).indexOf(1)>=0&&!this.hide_vis_input&&this.draw_overlay_bar(pe.select(".swapped_svg"),t,this.altered_chd_mat[t].slice(0,12).indexOf(1),this.get_color(0))}},draw_chord_overlay:function(){for(var t=0;t<this.original_chd_mat.length;t++)for(var e=this.original_chd_mat[t],i=e.slice(0,12).indexOf(1),n=0;n<12;n++)1==e[12+n]&&this.draw_overlay_bar(pe.select(".original_svg"),t,n,this.get_color((n-i)%12)),1!=this.altered_chd_mat[t][12+n]||this.hide_vis_input||this.draw_overlay_bar(pe.select(".swapped_svg"),t,n,this.get_color((n-this.altered_chd_mat[t].slice(0,12).indexOf(1))%12))},update_overlay:function(){this.clear_overlay(),this.chord_overlay?this.draw_chord_overlay():this.root_overlay&&this.draw_root_overlay()},root_on_click:function(){this.root_overlay?this.root_overlay=!1:this.root_overlay=!0,this.update_overlay()},chord_on_click:function(){this.chord_overlay?this.chord_overlay=!1:this.chord_overlay=!0,this.update_overlay()},draw_barlines_original:function(){pe.selectAll(".barline_original").remove().exit();for(var t=document.getElementById("time0").getBoundingClientRect(),e=document.getElementById("original_prog0").getBoundingClientRect(),i=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,r=t.top+window.pageYOffset||document.documentElement.scrollTop,c=e.bottom+window.pageYOffset||document.documentElement.scrollTop,s=1;s<4;s++)pe.selectAll("#original_barline").append("rect").attr("x",i+4*s*(n-i)).attr("y",r).attr("width",3).attr("height",c-r).attr("class","barline barline_original")},draw_barlines_altered:function(){pe.selectAll(".barline_altered").remove().exit();for(var t=document.getElementById("time_altered0").getBoundingClientRect(),e=document.getElementById("altered10").getBoundingClientRect(),i=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,r=t.top+window.pageYOffset||document.documentElement.scrollTop,c=e.bottom+window.pageYOffset||document.documentElement.scrollTop,s=1;s<4;s++)pe.selectAll("#altered_barline").append("rect").attr("x",i+4*s*(n-i)).attr("y",r).attr("width",3).attr("height",c-r).attr("class","barline barline_altered")},place_player_original:function(){var t=document.getElementById("time15").getBoundingClientRect(),e=document.getElementById("original_prog15").getBoundingClientRect(),i=t.right+window.pageXOffset||document.documentElement.scrollLeft,n=t.top+window.pageYOffset||document.documentElement.scrollTop,r=e.top+window.pageYOffset||document.documentElement.scrollTop;pe.select("#original_player").style("position","absolute").style("left",i+"px").style("top",(n+2.5*r)/3.5+"px").style("-webkit-transform","scale(0.75)").raise()},place_barlines_and_player:function(){this.draw_barlines_original(),this.draw_barlines_altered(),this.place_player_original(),this.place_melacc_toggle()},mel_on_click:function(){this.mel=!this.mel,this.mel||this.acc||(this.acc=!0),this.update_melacc_toggle()},acc_on_click:function(){this.acc=!this.acc,this.acc||this.mel||(this.mel=!0),this.update_melacc_toggle()},update_melacc_toggle:function(){this.mel&&this.acc?(this.notedic=this.notedic_mixed,this.original_noteseq=this.original_noteseq_mixed,this.original_noteseq_overlay=this.original_noteseq_mel):this.mel?(this.notedic=this.notedic_mel,this.original_noteseq=this.original_noteseq_mel,this.original_noteseq_overlay=this.empty_noteseq):(this.notedic=this.notedic_acc,this.original_noteseq=this.original_noteseq_acc,this.original_noteseq_overlay=this.empty_noteseq)},place_melacc_toggle:function(){var t=document.getElementById("time15").getBoundingClientRect(),e=document.getElementById("original_prog15").getBoundingClientRect(),i=t.left+window.pageXOffset||document.documentElement.scrollLeft,n=t.right+window.pageXOffset||document.documentElement.scrollLeft,r=t.top+window.pageYOffset||document.documentElement.scrollTop,c=e.top+window.pageYOffset||document.documentElement.scrollTop;pe.select("#melacc_toggle").style("position","absolute").style("left",n+(n-i)/4+"px").style("top",(1.15*r+c)/2.15+"px").style("-webkit-transform","scale(0.6)").raise()},play_chord:function(t,e){ve.stop();var i=0,n=16;if("original"==t){ve.start(this.chords_to_noteseq([this.original_chd_mat[e]],!1));for(var r=0;r<16;r++){if(""!=document.getElementById("original_prog"+r).innerHTML.replace(/\s/g,"")&&r>e){n=r;break}""!=document.getElementById("original_prog"+r).innerHTML.replace(/\s/g,"")&&(i=r)}for(var c=i;c<n;c++)this.highlight_cell("original_prog"+c,.5)}if("altered"==t){i=e-e%4;for(var s=i;s<i+4;s++)this.highlight_cell("altered"+s,.5);ve.start(this.chords_to_noteseq([this.altered_chd_mat[e]],!1))}},play_prog_original:function(){var t=this;ve.stop(),ve.start(this.chords_to_noteseq(this.original_chd_mat,!1));var e=0,i=function i(){if(e<16){if(t.highlight_cell("time"+e,t.prog_step_duration),""!=document.getElementById("original_prog"+e).innerHTML.replace(/\s/g,"")){for(var n=1,r=e+1;r<16;r++){if(""!=document.getElementById("original_prog"+r).innerHTML.replace(/\s/g,""))break;n++}for(var c=e;c<e+n;c++)t.highlight_cell("original_prog"+c,n*t.prog_step_duration)}e++,setTimeout((function(){i()}),1e3*t.prog_step_duration)}};i()},play_prog_altered:function(){var t=this;ve.stop(),ve.start(this.chords_to_noteseq(this.altered_chd_mat,!1));var e=0,i=function i(){if(e<16){if(e%4==0&&""==t.altered_chd_str[e])return;if(t.highlight_cell("time_altered"+e,t.prog_step_duration),""!=t.altered_chd_str[e])for(var n=e;n<e+4;n++)t.highlight_cell("altered"+n,4*t.prog_step_duration);e++,setTimeout((function(){i()}),1e3*t.prog_step_duration)}};i()},highlight_cell:function(t,e){document.getElementById(t).classList.add("cell_active"),setTimeout((function(){document.getElementById(t).classList.remove("cell_active")}),1e3*e)},replay_bar:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.loaded&&!this.playing||n){var r=this.t,c=(t-t%4)/4;if(0!=this.altered_noteseqs[c]){this.loaded=!1,this.t=4*(c+1),this.altered_noteseqs[c].totalQuantizedSteps=16,ve.isPlaying()&&ve.stop(),ve.start(this.altered_noteseqs[c],this.bpm),setTimeout((function(){ve.isPlaying()||(console.log(5),ve.start(e.altered_noteseqs[c],e.bpm))}),5),setTimeout((function(){ve.isPlaying()||(console.log(10),ve.start(e.altered_noteseqs[c],e.bpm))}),10),setTimeout((function(){ve.isPlaying()||(console.log(15),ve.start(e.altered_noteseqs[c],e.bpm))}),15),setTimeout((function(){ve.isPlaying()||(console.log(30),ve.start(e.altered_noteseqs[c],e.bpm))}),30),setTimeout((function(){ve.isPlaying()||(console.log(50),ve.start(e.altered_noteseqs[c],e.bpm))}),50);var s=function t(i){e.highlight_cell("time_altered"+i,6e4/e.bpm/1e3),i%4!=3&&setTimeout((function(){t(i+1)}),6e4/e.bpm)};s(this.t-4);for(var a=this.t-4;a<this.t;a++)this.highlight_cell("altered"+a,24e4/this.bpm/1e3);setTimeout((function(){e.t=r,i--,i>0?(ve.isPlaying()&&ve.stop(),e.replay_bar(t+4,i,!0)):e.loaded=!0}),24e4/this.bpm)}else this.loaded=!0}},replay_all:function(){this.replay_bar(2,4)},test_add:function(){0!=this.altered_noteseqs[3]&&(this.test_chd_strs.push(this.altered_chd_str),this.test_chds.push(this.chds))},test_apply:function(){var t=this;if(!this.playing&&0!=this.test_chd_strs.length){var e=Math.floor(Math.random()*this.test_chd_strs.length);this.hide_vis_input=!0,this.altered_chd_str_hide=this.test_chd_strs[e].slice(),this.altered_vis.noteSequence={notes:[{pitch:30,start:0,end:8}],totalTime:16},this.test_idx=e;var i=function i(n){t.update_current_chord(t.test_chds[e][n],t.test_chd_strs[e][4*n]),0==n?setTimeout((function(){i(n+1)}),225e3/t.bpm):n<3&&setTimeout((function(){i(n+1)}),24e4/t.bpm)};this.player_reset(),i(0)}},test_show_answer:function(){this.hide_vis_input&&!this.playing&&(this.hide_vis_input=!1,this.altered_chd_str=this.altered_chd_str_hide.slice(),this.update_overlay(),this.altered_vis.noteSequence=this.altered_noteseq,this.altered_vis.redraw())},test_clear:function(){this.test_chd_strs=[],this.test_chds=[],this.altered_chd_str_hide=[],this.test_idx=-1,this.hide_vis_input=!1},update_next_phrases:function(){if(-1==this.filter_h){for(var t=this.edge_weights.samples,e=0,i=0;i<t.length;i++)if(t[i]==this.songID){e=i;break}for(var n=[],r=0;r<this.edge_weights.mat[e].length;r++)n.push(this.edge_weights.mat[e][r]);for(var c=0;c<3;c++){var s=n.indexOf(Math.max.apply(Math,n));n[s]=-999;var a=t[s];a!=this.songID?(this.next_phrases_id[c]=a,this.next_phrases[c]=this.allData[a].original_noteseq_acc):c--}}else{var l={},o=[];console.log(this.allData);for(var h=0;h<this.edge_weights.samples.length;h++){var d=this.allData[this.edge_weights.samples[h]],_=Math.pow(d["hd"]-this.filter_h,2)+Math.pow(d["vd"]=this.filter_v,2);_ in l?l[_].push(h):(l[_]=[h],o.push(_))}console.log(l);var u=0;o.sort();for(var p=0;p<o.length;p++)for(var g=0;g<l[o[p]].length;g++){var f=this.edge_weights.samples[l[o[p]][g]];if(this.next_phrases_id[u]=f,this.next_phrases[u]=this.allData[f].original_noteseq_acc,u++,u>3)return}}},update_next_phrase:function(t){this.next_phrase_idx=t},set_filter:function(t){this.filter_h=t[0],this.filter_v=t[1],this.update_next_phrases()},apply_filter_anchors:function(){for(var t=[],e=[],i=0;i<this.edge_weights.samples.length;i++){var n=this.allData[this.edge_weights.samples[i]];t.push(n["vd"]),e.push(n["hd"])}t.sort(),e.sort();for(var r=[t[6],t[12],t[18],t[24]],c=[e[6],e[12],e[18],e[24]],s=0;s<this.edge_weights.samples.length;s++){for(var a=4,l=4,o=this.allData[this.edge_weights.samples[s]],h=o["vd"],d=o["hd"],_=3;_>=0;_--)h<r[_]&&(a=_),d<c[_]&&(l=_);o["vd"]=a,o["hd"]=l}},connect_midi:function(){var t=this;me.enable().then((function(){t.midi_device_names=[],t.show_midi_devices=!0,me.outputs.forEach((function(e){return t.midi_device_names.push(e.name)})),t.midi_device=me.outputs[0]})).catch((function(t){return alert(t)}))},output_midi:function(t){var e=6e4*(t.endTime-t.startTime)/this.bpm;this.show_midi_devices&&this.midi_device.channels[this.midi_channel].playNote(t.pitch,{duration:e})},change_midi_channel:function(t){this.midi_channel=t}},mounted:function(){var t=this;this.get_songdata(),this.get_data_all(),ve.loadAllSamples().then((function(){t.loaded=!0,t.altered_noteseq.notes=[]}));var e=this;ve.callbackObject={run:function(t){e.canvas_update_note(t),e.output_midi(t)},stop:function(){}},window.onresize=this.place_barlines_and_player,document.addEventListener("keydown",(function(e){var i=e.key;["e","E"].includes(i)&&t.player_reset(),["n","N"].includes(i)&&t.get_data(),["t","T"].includes(i)&&t.test_apply(),["s","S"].includes(i)&&t.test_show_answer(),["a","A"].includes(i)&&t.test_add(),["r","R"].includes(i)&&t.replay_all()}));var i={childList:!0,subtree:!0,attributes:!0},n=document.getElementById("original_player").shadowRoot.querySelector(".current-time"),r=document.getElementById("original_player").shadowRoot.querySelector(".controls");function c(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(t&&(t.classList.add("time_cell_active"),setTimeout((function(){t.classList.contains("time_cell_active")&&t.classList.remove("time_cell_active")}),1e3*i),!e.classList.contains("table_cell_active"))){e.classList.add("table_cell_active");var n=[e],r=i,c=document.getElementById("original_prog"+(1*n[n.length-1].id.slice(13,15)+1));while(c&&""==c.innerHTML.replace(/\s/g,""))c.classList.add("table_cell_active"),n.push(c),c=document.getElementById("original_prog"+(1*n[n.length-1].id.slice(13,15)+1)),r+=i;setTimeout((function(){while(n.length>0){var t=n.pop();t.classList.contains("table_cell_active")&&t.classList.remove("table_cell_active")}}),1e3*r)}}var s=function(t,e){var i,s=Object(Ft["a"])(t);try{for(s.s();!(i=s.n()).done;){i.value;if(r.classList.contains("playing")){var a=document.getElementById("time"+1*n.innerHTML.slice(2,4)),l=document.getElementById("original_prog"+1*n.innerHTML.slice(2,4));c(a,l)}}}catch(o){s.e(o)}finally{s.f()}},a=new MutationObserver(s);a.observe(r,i)}};i("22f8");ye.render=Rt;var Oe=ye;Object(n["b"])(Oe).mount("#app")},6:function(t,e){},7:function(t,e){},8:function(t,e){},9:function(t,e){},"9c32":function(t,e,i){"use strict";i("2d13")},ac5a:function(t,e,i){},b190:function(t,e,i){},bd23:function(t,e,i){"use strict";i("b190")},dc1a:function(t,e,i){"use strict";i("3653")}});
//# sourceMappingURL=app.a44ce241.js.map